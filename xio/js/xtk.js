/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function l(a){throw a;}var n=void 0,q=!0,r=null,s=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var w,da=this;function ea(){}
function fa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ga(a){return a!==n}function ka(a){return"array"==fa(a)}function la(a){var b=fa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ma(a){return"string"==typeof a}function y(a){return"number"==typeof a}function na(a){return"function"==fa(a)}function oa(a){var b=typeof a;return"object"==b&&a!=r||"function"==b}function pa(a){return a[qa]||(a[qa]=++ra)}var qa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;
function sa(a,b,c){return a.call.apply(a.bind,arguments)}function ta(a,b,c){a||l(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){ua=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sa:ta;return ua.apply(r,arguments)}
function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var xa=Date.now||function(){return+new Date};function C(a,b){var c=a.split("."),d=da;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ga(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function D(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ya(a,b,c){this.Ha=this.Ga=this.Fa=0;3==arguments.length?(this.Fa=Number(a),this.Ga=Number(b),this.Ha=Number(c)):a instanceof ya?(this.Fa=Number(a.x()),this.Ga=Number(a.y()),this.Ha=Number(a.b())):(this.Fa=Number(a[0]),this.Ga=Number(a[1]),this.Ha=Number(a[2]))}
ya.prototype={g:function(){return new ya(this.Fa,this.Ga,this.Ha)},Lb:function(a){return this.Fa*a.x()+this.Ga*a.y()+this.Ha*a.b()},Ud:function(a,b){return za(this,Aa(Ba(a,this),b))},length:function(){return Math.sqrt(this.Lb(this))},ac:function(a){return new ya(this.Ga*a.b()-this.Ha*a.y(),this.Ha*a.x()-this.Fa*a.b(),this.Fa*a.y()-this.Ga*a.x())},x:t("Fa"),y:t("Ga"),b:t("Ha")};function Ca(a){var b=a.length();return new ya(a.Fa/b,a.Ga/b,a.Ha/b)}
function Aa(a,b){return new ya(a.Fa*b,a.Ga*b,a.Ha*b)}function Ba(a,b){return new ya(a.Fa-b.x(),a.Ga-b.y(),a.Ha-b.b())}function za(a,b){return new ya(a.Fa+b.x(),a.Ga+b.y(),a.Ha+b.b())}function Ea(a){return new ya(-a.Fa,-a.Ga,-a.Ha)};var I=I||{};I.jj=q;I.va=function(a){eval("X.DEV === undefined")||window.console.time(a)};I.qa=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.gh=0;this.fj=function(){return this.gh++}};function Fa(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);c in a||(d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c])}}var Ga=window.Yg;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&l(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ha=0,Ia=["ms","moz","webkit","o"],Ka=0;Ka<Ia.length&&!window.requestAnimationFrame;++Ka)window.requestAnimationFrame=window[Ia[Ka]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ia[Ka]+"CancelAnimationFrame"]||window[Ia[Ka]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ha)),d=window.setTimeout(function(){a(b+c)},c);Ha=b+c;return d});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===n&&l(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});C("$",Ga);C("Function.prototype.bind",Function.prototype.bind);
C("window.requestAnimationFrame",window.requestAnimationFrame);C("window.cancelAnimationFrame",window.cancelAnimationFrame);var La=0;function Ma(){}w=Ma.prototype;w.key=0;w.ec=s;w.Hd=s;w.ka=function(a,b,c,d,e,f){na(a)?this.ng=q:a&&a.handleEvent&&na(a.handleEvent)?this.ng=s:l(Error("Invalid listener argument"));this.Mb=a;this.Gg=b;this.src=c;this.type=d;this.capture=!!e;this.Se=f;this.Hd=s;this.key=++La;this.ec=s};w.handleEvent=function(a){return this.ng?this.Mb.call(this.Se||this.src,a):this.Mb.handleEvent.call(this.Mb,a)};function Na(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}var Oa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Oa.length;f++)c=Oa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Qa(a){if(!Ra.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Sa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ta,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ua,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Va,"&quot;"));return a}var Sa=/&/g,Ta=/</g,Ua=/>/g,Va=/\"/g,Ra=/[&<>\"]/;var Wa,Xa,Ya,Za,ab,bb,cb;function db(){return da.navigator?da.navigator.userAgent:r}function eb(){return da.navigator}Za=Ya=Xa=Wa=s;var fb;if(fb=db()){var gb=eb();Wa=0==fb.indexOf("Opera");Xa=!Wa&&-1!=fb.indexOf("MSIE");Ya=!Wa&&-1!=fb.indexOf("WebKit");Za=!Wa&&!Ya&&"Gecko"==gb.product}var kb=Wa,L=Xa,lb=Za,mb=Ya,nb,ob=eb();nb=ob&&ob.platform||"";ab=-1!=nb.indexOf("Mac");bb=-1!=nb.indexOf("Win");cb=-1!=nb.indexOf("Linux");var pb=!!eb()&&-1!=(eb().appVersion||"").indexOf("X11");
function qb(){var a=da.document;return a?a.documentMode:n}var rb;a:{var sb="",tb;if(kb&&da.opera)var ub=da.opera.version,sb="function"==typeof ub?ub():ub;else if(lb?tb=/rv\:([^\);]+)(\)|;)/:L?tb=/MSIE\s+([^\);]+)(\)|;)/:mb&&(tb=/WebKit\/(\S+)/),tb)var vb=tb.exec(db()),sb=vb?vb[1]:"";if(L){var wb=qb();if(wb>parseFloat(sb)){rb=String(wb);break a}}rb=sb}var xb={};
function yb(a){var b;if(!(b=xb[a])){b=0;for(var c=String(rb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var m=j.exec(g)||["","",""],p=k.exec(h)||["","",""];if(0==m[0].length&&0==p[0].length)break;b=((0==m[1].length?0:parseInt(m[1],10))<(0==p[1].length?0:parseInt(p[1],10))?-1:(0==m[1].length?0:parseInt(m[1],
10))>(0==p[1].length?0:parseInt(p[1],10))?1:0)||((0==m[2].length)<(0==p[2].length)?-1:(0==m[2].length)>(0==p[2].length)?1:0)||(m[2]<p[2]?-1:m[2]>p[2]?1:0)}while(0==b)}b=xb[a]=0<=b}return b}var zb=da.document,Bb=!zb||!L?n:qb()||("CSS1Compat"==zb.compatMode?parseInt(rb,10):5);var Cb=!L||L&&9<=Bb,Db=L&&!yb("9");!mb||yb("528");lb&&yb("1.9b")||L&&yb("8")||kb&&yb("9.5")||mb&&yb("528");lb&&!yb("8")||L&&yb("9");var Eb=Array.prototype,Fb=Eb.indexOf?function(a,b,c){return Eb.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(ma(a))return!ma(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Gb=Eb.forEach?function(a,b,c){Eb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Hb=Eb.map?function(a,b,c){return Eb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ma(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ib=Eb.some?function(a,b,c){return Eb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return q;return s};function Jb(a,b){var c=Fb(a,b);0<=c&&Eb.splice.call(a,c,1)}function Kb(a,b,c){return 2>=arguments.length?Eb.slice.call(a,b):Eb.slice.call(a,b,c)};function Lb(){0!=Mb&&(this.dk=Error().stack,pa(this))}var Mb=0;function Nb(a,b){this.type=a;this.currentTarget=this.target=b}w=Nb.prototype;w.dc=s;w.defaultPrevented=s;w.Zd=q;w.stopPropagation=function(){this.dc=q};w.preventDefault=function(){this.defaultPrevented=q;this.Zd=s};function Ob(a){Ob[" "](a);return a}Ob[" "]=ea;function Pb(a,b){a&&this.ka(a,b)}D(Pb,Nb);w=Pb.prototype;w.target=r;w.relatedTarget=r;w.offsetX=0;w.offsetY=0;w.clientX=0;w.clientY=0;w.screenX=0;w.screenY=0;w.button=0;w.keyCode=0;w.charCode=0;w.ctrlKey=s;w.altKey=s;w.shiftKey=s;w.metaKey=s;w.Oi=s;w.Sa=r;
w.ka=function(a,b){var c=this.type=a.type;Nb.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(lb){var e;a:{try{Ob(d.nodeName);e=q;break a}catch(f){}e=s}e||(d=r)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=mb||a.offsetX!==n?a.offsetX:a.layerX;this.offsetY=mb||a.offsetY!==n?a.offsetY:a.layerY;this.clientX=a.clientX!==n?a.clientX:a.pageX;this.clientY=a.clientY!==n?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Oi=ab?a.metaKey:a.ctrlKey;this.state=a.state;this.Sa=a;a.defaultPrevented&&this.preventDefault();delete this.dc};w.stopPropagation=function(){Pb.q.stopPropagation.call(this);this.Sa.stopPropagation?this.Sa.stopPropagation():this.Sa.cancelBubble=q};
w.preventDefault=function(){Pb.q.preventDefault.call(this);var a=this.Sa;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,Db)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};w.Lh=t("Sa");var Qb={},Rb={},Tb={},Ub={};function Vb(a,b,c,d,e){if(ka(b)){for(var f=0;f<b.length;f++)Vb(a,b[f],c,d,e);return r}a=Wb(a,b,c,s,d,e);b=a.key;Qb[b]=a;return b}
function Wb(a,b,c,d,e,f){b||l(Error("Invalid event type"));e=!!e;var g=Rb;b in g||(g[b]={Y:0,ua:0});g=g[b];e in g||(g[e]={Y:0,ua:0},g.Y++);var g=g[e],h=pa(a),j;g.ua++;if(g[h]){j=g[h];for(var k=0;k<j.length;k++)if(g=j[k],g.Mb==c&&g.Se==f){if(g.ec)break;d||(j[k].Hd=s);return j[k]}}else j=g[h]=[],g.Y++;var m=Xb,p=Cb?function(a){return m.call(p.src,p.Mb,a)}:function(a){a=m.call(p.src,p.Mb,a);if(!a)return a},k=p,g=new Ma;g.ka(c,k,a,b,e,f);g.Hd=d;k.src=a;k.Mb=g;j.push(g);Tb[h]||(Tb[h]=[]);Tb[h].push(g);
a.addEventListener?(a==da||!a.customEvent_)&&a.addEventListener(b,k,e):a.attachEvent(b in Ub?Ub[b]:Ub[b]="on"+b,k);return g}function Yb(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)Yb(a,b[f],c,d,e);else a=Wb(a,b,c,q,d,e),Qb[a.key]=a}function Zb(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)Zb(a,b[f],c,d,e);else{d=!!d;a:{f=Rb;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].Mb==c&&a[f].capture==d&&a[f].Se==e){$b(a[f].key);break}}}
function $b(a){var b=Qb[a];if(!b||b.ec)return s;var c=b.src,d=b.type,e=b.Gg,f=b.capture;c.removeEventListener?(c==da||!c.customEvent_)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Ub?Ub[d]:Ub[d]="on"+d,e);c=pa(c);Tb[c]&&(e=Tb[c],Jb(e,b),0==e.length&&delete Tb[c]);b.ec=q;if(b=Rb[d][f][c])b.vg=q,ac(d,f,c,b);delete Qb[a];return q}
function ac(a,b,c,d){if(!d.Wd&&d.vg){for(var e=0,f=0;e<d.length;e++)d[e].ec?d[e].Gg.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.vg=s;0==f&&(delete Rb[a][b][c],Rb[a][b].Y--,0==Rb[a][b].Y&&(delete Rb[a][b],Rb[a].Y--),0==Rb[a].Y&&delete Rb[a])}}function bc(a,b,c,d,e){var f=1;b=pa(b);if(a[b]){var g=--a.ua,h=a[b];h.Wd?h.Wd++:h.Wd=1;try{for(var j=h.length,k=0;k<j;k++){var m=h[k];m&&!m.ec&&(f&=cc(m,e)!==s)}}finally{a.ua=Math.max(g,a.ua),h.Wd--,ac(c,d,b,h)}}return Boolean(f)}
function cc(a,b){a.Hd&&$b(a.key);return a.handleEvent(b)}
function Xb(a,b){if(a.ec)return q;var c=a.type,d=Rb;if(!(c in d))return q;var d=d[c],e,f;if(!Cb){var g;if(!(g=b))a:{g=["window","event"];for(var h=da;e=g.shift();)if(h[e]!=r)h=h[e];else{g=r;break a}g=h}e=g;g=q in d;h=s in d;if(g){if(0>e.keyCode||e.returnValue!=n)return q;a:{var j=s;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(k){j=q}if(j||e.returnValue==n)e.returnValue=q}}j=new Pb;j.ka(e,this);e=q;try{if(g){for(var m=[],p=j.currentTarget;p;p=p.parentNode)m.push(p);f=d[q];f.ua=f.Y;for(var u=m.length-
1;!j.dc&&0<=u&&f.ua;u--)j.currentTarget=m[u],e&=bc(f,m[u],c,q,j);if(h){f=d[s];f.ua=f.Y;for(u=0;!j.dc&&u<m.length&&f.ua;u++)j.currentTarget=m[u],e&=bc(f,m[u],c,s,j)}}else e=cc(a,j)}finally{m&&(m.length=0)}return e}c=new Pb(b,this);return e=cc(a,c)}var dc=0;function ec(a){return a+"_"+dc++};function fc(){Lb.call(this);this.gk={};this.bk=this}D(fc,Lb);fc.prototype.customEvent_=q;w=fc.prototype;w.ff=r;w.lf=ba("ff");w.addEventListener=function(a,b,c,d){Vb(this,a,b,c,d)};w.removeEventListener=function(a,b,c,d){Zb(this,a,b,c,d)};
w.dispatchEvent=function(a){var b=a.type||a,c=Rb;if(b in c){if(ma(a))a=new Nb(a,this);else if(a instanceof Nb)a.target=a.target||this;else{var d=a;a=new Nb(b,this);Pa(a,d)}var d=1,e,c=c[b],b=q in c,f;if(b){e=[];for(f=this;f;f=f.ff)e.push(f);f=c[q];f.ua=f.Y;for(var g=e.length-1;!a.dc&&0<=g&&f.ua;g--)a.currentTarget=e[g],d&=bc(f,e[g],a.type,q,a)&&a.Zd!=s}if(s in c)if(f=c[s],f.ua=f.Y,b)for(g=0;!a.dc&&g<e.length&&f.ua;g++)a.currentTarget=e[g],d&=bc(f,e[g],a.type,s,a)&&a.Zd!=s;else for(e=this;!a.dc&&e&&
f.ua;e=e.ff)a.currentTarget=e,d&=bc(f,e,a.type,s,a)&&a.Zd!=s;a=Boolean(d)}else a=q;return a};function M(){fc.call(this);this.c="base";this.ga=window["X.counter"].fj();this.e=s}D(M,fc);M.prototype.__defineGetter__("classname",t("c"));M.prototype.__defineGetter__("id",t("ga"));C("X.base",M);function gc(a,b){this.Ea=new ya(a);this.ea=new ya(b)}gc.prototype={g:function(){return new gc(this.Ea.g(),this.ea.g())},cc:function(){this.ea=Ea(this.ea)}};function hc(a,b){this.ea=a;this.nd=b}hc.prototype={g:function(){return new hc(this.ea.g(),this.nd)},cc:function(){this.ea=Ea(this.ea);this.nd=-this.nd}};function ic(a,b){this.qb=a;this.fe=b;var c=a[0].Ea,d=a[2].Ea,d=Ca(Ba(a[1].Ea,c).ac(Ba(d,c)));this.Da=new hc(d,d.Lb(c))}ic.prototype={g:function(){var a=this.qb.map(function(a){return a.g()});return new ic(a,this.fe)},cc:function(){this.qb.reverse().map(function(a){a.cc()});this.Da.cc()}};
function jc(a,b,c,d,e,f){for(var g=0,h=[],j=0;j<a.qb.length;j++){var k=b.ea.Lb(a.qb[j].Ea)-b.nd,k=-1E-5>k?2:1E-5<k?1:0,g=g|k;h.push(k)}switch(g){case 0:(0<b.ea.Lb(a.Da.ea)?c:d).push(a);break;case 1:e.push(a);break;case 2:f.push(a);break;case 3:c=[];d=[];for(j=0;j<a.qb.length;j++){var m=(j+1)%a.qb.length,k=h[j],p=h[m],g=a.qb[j],m=a.qb[m];2!=k&&c.push(g);1!=k&&d.push(2!=k?g.g():g);3==(k|p)&&(k=(b.nd-b.ea.Lb(g.Ea))/b.ea.Lb(Ba(m.Ea,g.Ea)),k=new gc(g.Ea.Ud(m.Ea,k),g.ea.Ud(m.ea,k)),c.push(k),d.push(k.g()))}3<=
c.length&&e.push(new ic(c,a.fe));3<=d.length&&f.push(new ic(d,a.fe))}};function kc(a){this.ia=this.ja=this.Da=r;this.I=[];a&&lc(this,a)}kc.prototype={g:function(){var a=new kc,b=this.Da&&this.Da.g();a.Da=b;b=this.ja&&this.ja.g();a.ja=b;b=this.ia&&this.ia.g();a.ia=b;a.de(this.I.map(function(a){return a.g()}));return a},L:function(){for(var a=0;a<this.I.length;a++)this.I[a].cc();this.Da.cc();this.ja&&this.ja.L();this.ia&&this.ia.L();a=this.ja;this.ja=this.ia;this.ia=a},de:ba("I")};
function lc(a,b){if(b.length){a.Da||(a.Da=b[0].Da.g());for(var c=[],d=[],e=0;e<b.length;e++)jc(b[e],a.Da,a.I,a.I,c,d);c.length&&(a.ja||(a.ja=new kc),lc(a.ja,c));d.length&&(a.ia||(a.ia=new kc),lc(a.ia,d))}}function mc(a){var b=a.I.slice();a.ja&&(b=b.concat(mc(a.ja)));a.ia&&(b=b.concat(mc(a.ia)));return b}function oc(a,b){a.I=pc(b,a.I);a.ja&&oc(a.ja,b);a.ia&&oc(a.ia,b)}
function pc(a,b){if(!a.Da)return b.slice();for(var c=[],d=[],e=0;e<b.length;e++)jc(b[e],a.Da,c,d,c,d);a.ja&&(c=pc(a.ja,c));d=a.ia?pc(a.ia,d):[];return c.concat(d)};function qc(){this.I=[]}function rc(a){var b=new qc;b.de(a);return b}
qc.prototype={g:function(){var a=new qc;a.de(this.I.map(function(a){return a.g()}));return a},tf:function(a){var b=new kc(this.g().I);a=new kc(a.g().I);oc(b,a);oc(a,b);a.L();oc(a,b);a.L();lc(b,mc(a));return rc(mc(b))},pa:function(a){var b=new kc(this.g().I);a=new kc(a.g().I);b.L();oc(b,a);oc(a,b);a.L();oc(a,b);a.L();lc(b,mc(a));b.L();return rc(mc(b))},Ue:function(a){var b=new kc(this.g().I);a=new kc(a.g().I);b.L();oc(a,b);a.L();oc(b,a);oc(a,b);lc(b,mc(a));b.L();return rc(mc(b))},inverse:function(){var a=
this.g();a.I.map(function(a){a.cc()});return a},de:ba("I")};function sc(){M.call(this);this.c="indexer";this.Ee=[];this.Yj=[];this.zb={}}D(sc,M);sc.prototype.add=function(a){a==r&&l(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.zb||(this.zb[b]=this.Ee.length,this.Ee.push(a));return this.zb[b]};sc.prototype.unique=t("Ee");function tc(a){M.call(this);this.c="file";this.xd=a;this.e=q}D(tc,M);function uc(){this.Wa=this.m=r}uc.prototype.__defineSetter__("file",function(a){if(a==r||ka(a)&&0==a.length)this.m=r;else{if(ka(a)){if(1==a.length){this.m=new tc(a[0]);return}this.m=Hb(a,function(a){var c=new P;c.m=new tc(a);return c})}else this.m=new tc(a);this.Wa=r}});uc.prototype.__defineGetter__("file",function(){return!this.m?"":ka(this.m)?this.m.map(function(a){return a.m.xd}):this.m.xd});
uc.prototype.__defineGetter__("filedata",function(){return ka(this.m)?this.m.map(function(a){return a.Wa}):this.Wa});uc.prototype.__defineSetter__("filedata",function(a){if(a==r||ka(a)&&0==a.length)this.Wa=r;if(ka(a))if(1==a.length)this.Wa=a[0];else{var b=this.m.length,c;for(c=0;c<b;c++)this.m[c].Wa=a[c]}else this.Wa=a});function vc(a){if("function"==typeof a.bd)return a.bd();if(ma(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Na(a)};function wc(a,b){this.A={};this.D=[];var c=arguments.length;if(1<c){c%2&&l(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.Ge(a)}w=wc.prototype;w.Y=0;w.vf=0;w.Nd=t("Y");w.bd=function(){xc(this);for(var a=[],b=0;b<this.D.length;b++)a.push(this.A[this.D[b]]);return a};function yc(a){for(var b=0;b<a.D.length;b++){var c=a.D[b];if(zc(a.A,c)&&a.A[c]==s)return q}return s}w.clear=function(){this.A={};this.vf=this.Y=this.D.length=0};
w.remove=function(a){return zc(this.A,a)?(delete this.A[a],this.Y--,this.vf++,this.D.length>2*this.Y&&xc(this),q):s};function xc(a){if(a.Y!=a.D.length){for(var b=0,c=0;b<a.D.length;){var d=a.D[b];zc(a.A,d)&&(a.D[c++]=d);b++}a.D.length=c}if(a.Y!=a.D.length){for(var e={},c=b=0;b<a.D.length;)d=a.D[b],zc(e,d)||(a.D[c++]=d,e[d]=1),b++;a.D.length=c}}w.get=function(a,b){return zc(this.A,a)?this.A[a]:b};w.set=function(a,b){zc(this.A,a)||(this.Y++,this.D.push(a),this.vf++);this.A[a]=b};
w.Ge=function(a){var b;if(a instanceof wc)xc(a),b=a.D.concat(),a=a.bd();else{b=[];var c=0,d;for(d in a)b[c++]=d;a=Na(a)}for(c=0;c<b.length;c++)this.set(b[c],a[c])};w.g=function(){return new wc(this)};w.sf=function(){for(var a=new wc,b=0;b<this.D.length;b++){var c=this.D[b];a.set(this.A[c],c)}return a};function zc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Ac(){M.call(this);this.c="colortable";this.zb=new wc;Fa(this,new uc)}D(Ac,M);Ac.prototype.add=function(a,b,c,d,e,f){(!y(a)||!y(c)||!y(d)||!y(e)||!y(f))&&l(Error("Invalid color table entry."));this.zb.set(a,[b,c,d,e,f]);this.e=q};Ac.prototype.get=function(a){return this.zb.get(a)};C("X.colortable.prototype.get",Ac.prototype.get);function Bc(a,b,c){this.x=ga(a)?a:0;this.y=ga(b)?b:0;this.b=ga(c)?c:0}Bc.prototype.g=function(){return new Bc(this.x,this.y,this.b)};function Q(a,b,c){this.x=a;this.y=b;this.b=c}D(Q,Bc);w=Q.prototype;w.g=function(){return new Q(this.x,this.y,this.b)};w.mb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};w.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};w.L=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};w.normalize=function(){return this.scale(1/this.mb())};w.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
w.pa=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};function Cc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return c*c+d*d+e*e}function Dc(a,b){return new Q(a.x+b.x,a.y+b.y,a.b+b.b)}function Ec(a,b){return new Q(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};I.f=Q;w=I.f.prototype;w.g=Q.prototype.g;w.mb=Q.prototype.mb;w.scale=Q.prototype.scale;w.L=Q.prototype.L;w.add=Q.prototype.add;w.pa=Q.prototype.pa;w.normalize=function(){var a=this.mb();return 0==a?this.scale(0):this.scale(1/a)};I.f.Lb=function(a,b){return a.x*b.x+a.y*b.y+a.b*b.b};I.f.ac=Ec;I.f.kb=function(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)};I.f.Ud=function(a,b,c){return new Q(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.b+c*(b.b-a.b))};I.f.prototype.__defineGetter__("xx",t("x"));
I.f.prototype.__defineGetter__("yy",t("y"));I.f.prototype.__defineGetter__("zz",t("b"));C("X.vector",I.f);C("X.vector.prototype.clone",I.f.prototype.g);C("X.vector.prototype.magnitude",I.f.prototype.mb);C("X.vector.prototype.scale",I.f.prototype.scale);C("X.vector.prototype.invert",I.f.prototype.L);C("X.vector.prototype.normalize",I.f.prototype.normalize);C("X.vector.prototype.add",I.f.prototype.add);C("X.vector.prototype.subtract",I.f.prototype.pa);C("X.vector.dot",I.f.Lb);C("X.vector.cross",I.f.ac);
C("X.vector.distance",I.f.kb);C("X.vector.lerp",I.f.Ud);function Fc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Fc.prototype.BYTES_PER_ELEMENT=8;Fc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Fc.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Fc.BYTES_PER_ELEMENT=8}catch(Gc){}Fc.prototype.BYTES_PER_ELEMENT=Fc.prototype.BYTES_PER_ELEMENT;Fc.prototype.set=Fc.prototype.set;Fc.prototype.toString=Fc.prototype.toString;C("Float64Array",Fc)};function Hc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Hc.prototype.BYTES_PER_ELEMENT=4;Hc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Hc.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Hc.BYTES_PER_ELEMENT=4,Hc.prototype.BYTES_PER_ELEMENT=Hc.prototype.BYTES_PER_ELEMENT,Hc.prototype.set=Hc.prototype.set,Hc.prototype.toString=Hc.prototype.toString,C("Float32Array",Hc));function Ic(){var a=new Float32Array(16);a[0]=a[5]=a[10]=a[15]=1;return a}function Jc(a,b,c,d,e,f,g,h,j,k,m,p,u,x,v,z,F){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=j;a[8]=k;a[9]=m;a[10]=p;a[11]=u;a[12]=x;a[13]=v;a[14]=z;a[15]=F;return a}function Kc(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3]}function Lc(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3]}function Mc(a,b,c,d,e,f){a[b]=c;a[b+4]=d;a[b+8]=e;a[b+12]=f}
function Nc(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function Oc(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12]}function Pc(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],f=a[2]*b+a[6]*c+a[10]*d+a[14],g=a[3]*b+a[7]*c+a[11]*d+a[15];a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=e;a[14]=f;a[15]=g;return a}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);I.d={};I.d.rg=function(a,b,c,d){c=c.pa(b);c.normalize();d=I.f.ac(c,d);d.normalize();var e=I.f.ac(d,c);e.normalize();c.L();Mc(a,0,d.x,d.y,d.b,0);Mc(a,1,e.x,e.y,e.b,0);Mc(a,2,c.x,c.y,c.b,0);Pc(a,-b.x,-b.y,-b.b);return a};I.d.Ta=function(a,b,c,d){var e=1/(b*a[3]+c*a[7]+d*a[11]+a[15]);return new I.f((b*a[0]+c*a[4]+d*a[8]+a[12])*e,(b*a[1]+c*a[5]+d*a[9]+a[13])*e,(b*a[2]+c*a[6]+d*a[10]+a[14])*e)};
I.d.dj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);Oc(a,b,d);Oc(a,c,e);Nc(a,b,e);Nc(a,c,d);return a};I.d.cj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);Lc(a,b,d);Lc(a,c,e);Kc(a,b,e);Kc(a,c,d);return a};I.d.cd=Ic;I.d.g=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
I.d.sf=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=d;b[9]=f;b[11]=a[14];b[12]=e;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
I.d.Ah=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],j=a[7],k=a[8],m=a[9],p=a[10],u=a[11],x=a[12],v=a[13],z=a[14];a=a[15];return(b*g-c*f)*(p*a-u*z)-(b*h-d*f)*(m*a-u*v)+(b*j-e*f)*(m*z-p*v)+(c*h-d*g)*(k*a-u*x)-(c*j-e*g)*(k*z-p*x)+(d*j-e*h)*(k*v-m*x)};
I.d.L=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],j=a[6],k=a[7],m=a[8],p=a[9],u=a[10],x=a[11],v=a[12],z=a[13],F=a[14],E=a[15],H=c*h-d*g,B=c*j-e*g,G=c*k-f*g,J=d*j-e*h,U=d*k-f*h,N=e*k-f*j,K=m*z-p*v,O=m*F-u*v,R=m*E-x*v,S=p*F-u*z,V=p*E-x*z,ja=u*E-x*F,A=H*ja-B*V+G*S+J*R-U*O+N*K;if(0==A)return s;A=1/A;b[0]=(h*ja-j*V+k*S)*A;b[1]=(-d*ja+e*V-f*S)*A;b[2]=(z*N-F*U+E*J)*A;b[3]=(-p*N+u*U-x*J)*A;b[4]=(-g*ja+j*R-k*O)*A;b[5]=(c*ja-e*R+f*O)*A;b[6]=(-v*N+F*G-E*B)*A;b[7]=(m*N-u*G+x*B)*A;b[8]=(g*V-h*
R+k*K)*A;b[9]=(-c*V+d*R-f*K)*A;b[10]=(v*U-z*G+E*H)*A;b[11]=(-m*U+p*G-x*H)*A;b[12]=(-g*S+h*O-j*K)*A;b[13]=(c*S-d*O+e*K)*A;b[14]=(-v*J+z*B-F*H)*A;b[15]=(m*J-p*B+u*H)*A;return q};I.d.We=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return Jc(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0)};I.d.fi=function(a,b,c,d,e,f,g){return Jc(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};
I.d.gi=function(a,b,c,d,e,f,g){return Jc(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)};
I.d.multiply=function(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],j=a[5],k=a[6],m=a[7],p=a[8],u=a[9],x=a[10],v=a[11],z=a[12],F=a[13],E=a[14];a=a[15];var H=b[0],B=b[1],G=b[2],J=b[3],U=b[4],N=b[5],K=b[6],O=b[7],R=b[8],S=b[9],V=b[10],ja=b[11],A=b[12],T=b[13],ha=b[14];b=b[15];c[0]=d*H+h*B+p*G+z*J;c[1]=e*H+j*B+u*G+F*J;c[2]=f*H+k*B+x*G+E*J;c[3]=g*H+m*B+v*G+a*J;c[4]=d*U+h*N+p*K+z*O;c[5]=e*U+j*N+u*K+F*O;c[6]=f*U+k*N+x*K+E*O;c[7]=g*U+m*N+v*K+a*O;c[8]=d*R+h*S+p*V+z*ja;c[9]=e*R+j*S+u*V+F*ja;c[10]=f*R+k*S+
x*V+E*ja;c[11]=g*R+m*S+v*V+a*ja;c[12]=d*A+h*T+p*ha+z*b;c[13]=e*A+j*T+u*ha+F*b;c[14]=f*A+k*T+x*ha+E*b;c[15]=g*A+m*T+v*ha+a*b;return c};I.d.translate=Pc;I.d.scale=function(a,b,c,d){return Jc(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])};
I.d.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],j=a[3],k=a[4],m=a[5],p=a[6],u=a[7],x=a[8],v=a[9],z=a[10],F=a[11],E=Math.cos(b),H=Math.sin(b),B=1-E;b=c*c*B+E;var G=c*d*B+e*H,J=c*e*B-d*H,U=c*d*B-e*H,N=d*d*B+E,K=d*e*B+c*H,O=c*e*B+d*H;c=d*e*B-c*H;e=e*e*B+E;return Jc(a,f*b+k*G+x*J,g*b+m*G+v*J,h*b+p*G+z*J,j*b+u*G+F*J,f*U+k*N+x*K,g*U+m*N+v*K,h*U+p*N+z*K,j*U+u*N+F*K,f*O+k*c+x*e,g*O+m*c+v*e,h*O+p*c+z*e,j*O+u*c+F*e,a[12],a[13],a[14],a[15])};
I.d.$d=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],j=a[10],k=a[11],m=Math.cos(b),p=Math.sin(b);a[4]=c*m+g*p;a[5]=d*m+h*p;a[6]=e*m+j*p;a[7]=f*m+k*p;a[8]=c*-p+g*m;a[9]=d*-p+h*m;a[10]=e*-p+j*m;a[11]=f*-p+k*m;return a};I.d.ae=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],j=a[10],k=a[11],m=Math.cos(b),p=Math.sin(b);a[0]=c*m+g*-p;a[1]=d*m+h*-p;a[2]=e*m+j*-p;a[3]=f*m+k*-p;a[8]=c*p+g*m;a[9]=d*p+h*m;a[10]=e*p+j*m;a[11]=f*p+k*m;return a};
I.d.be=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],j=a[6],k=a[7],m=Math.cos(b),p=Math.sin(b);a[0]=c*m+g*p;a[1]=d*m+h*p;a[2]=e*m+j*p;a[3]=f*m+k*p;a[4]=c*-p+g*m;a[5]=d*-p+h*m;a[6]=e*-p+j*m;a[7]=f*-p+k*m;return a};C("X.matrix.identity",I.d.cd);C("X.matrix.clone",I.d.g);C("X.matrix.transpose",I.d.sf);C("X.matrix.determinant",I.d.Ah);C("X.matrix.invert",I.d.L);C("X.matrix.multiply",I.d.multiply);C("X.matrix.multiplyByVector",I.d.Ta);C("X.matrix.makePerspective",I.d.We);
C("X.matrix.makeFrustum",I.d.fi);C("X.matrix.makeOrtho",I.d.gi);C("X.matrix.makeLookAt",I.d.rg);C("X.matrix.translate",I.d.translate);C("X.matrix.scale",I.d.scale);C("X.matrix.rotate",I.d.rotate);C("X.matrix.rotateX",I.d.$d);C("X.matrix.rotateY",I.d.ae);C("X.matrix.rotateZ",I.d.be);C("X.matrix.swapRows",I.d.dj);C("X.matrix.swapCols",I.d.cj);function Qc(){M.call(this);this.c="transform";this.ha=I.d.cd()}D(Qc,M);Qc.prototype.__defineGetter__("matrix",t("ha"));Qc.prototype.__defineSetter__("matrix",function(a){(a==r||!(a instanceof Float32Array))&&l(Error("Invalid matrix."));this.ha=a;this.l()});w=Qc.prototype;w.$d=function(a){(!y(a)||-360>a||360<a)&&l(Error("Invalid angle."));I.d.$d(this.ha,a*Math.PI/180);this.l()};w.ae=function(a){(!y(a)||-360>a||360<a)&&l(Error("Invalid angle."));I.d.ae(this.ha,a*Math.PI/180);this.l()};
w.be=function(a){(!y(a)||-360>a||360<a)&&l(Error("Invalid angle."));I.d.be(this.ha,a*Math.PI/180);this.l()};w.Qg=function(a){y(a)||l(Error("Invalid distance."));I.d.translate(this.ha,a,0,0);this.l()};w.Rg=function(a){y(a)||l(Error("Invalid distance."));I.d.translate(this.ha,0,a,0);this.l()};w.Sg=function(a){y(a)||l(Error("Invalid distance."));I.d.translate(this.ha,0,0,a);this.l()};function Rc(a,b,c){a.ha[b+4*c]*=-1;a.l()}w.Hh=function(){Rc(this,0,0)};w.Ih=function(){Rc(this,1,1)};
w.Jh=function(){Rc(this,2,2)};w.l=function(){this.e=q};C("X.transform",Qc);C("X.transform.prototype.rotateX",Qc.prototype.$d);C("X.transform.prototype.rotateY",Qc.prototype.ae);C("X.transform.prototype.rotateZ",Qc.prototype.be);C("X.transform.prototype.translateX",Qc.prototype.Qg);C("X.transform.prototype.translateY",Qc.prototype.Rg);C("X.transform.prototype.translateZ",Qc.prototype.Sg);C("X.transform.prototype.flipX",Qc.prototype.Hh);C("X.transform.prototype.flipY",Qc.prototype.Ih);
C("X.transform.prototype.flipZ",Qc.prototype.Jh);C("X.transform.prototype.modified",Qc.prototype.l);function Sc(){M.call(this);this.c="texture";this.Fb=this.tb=this.m=r;this.we=this.xe=0;Fa(this,new uc)}D(Sc,M);Sc.prototype.__defineSetter__("rawData",function(a){this.Fb=a;this.e=q});Sc.prototype.__defineSetter__("rawDataHeight",function(a){this.we=a;this.e=q});Sc.prototype.__defineSetter__("rawDataWidth",function(a){this.xe=a;this.e=q});C("X.texture",Sc);function W(a,b){M.call(this);this.c="triplets";this.Ub=Infinity;this.Rb=-Infinity;this.Vb=Infinity;this.Sb=-Infinity;this.Wb=Infinity;this.Tb=-Infinity;this.od=[0,0,0];this.Cf=q;this.F=0;this.Q=new Float32Array(a);b!=r&&(this.Q=b.Q.subarray(0,b.Q.length),this.F=this.Q.length,this.Ub=b.Ub,this.Rb=b.Rb,this.Vb=b.Vb,this.Sb=b.Sb,this.Wb=b.Wb,this.Tb=b.Tb,this.od=b.od.slice(),this.Cf=s)}D(W,M);w=W.prototype;
w.add=function(a,b,c){this.Ub=Math.min(this.Ub,a);this.Rb=Math.max(this.Rb,a);this.Vb=Math.min(this.Vb,b);this.Sb=Math.max(this.Sb,b);this.Wb=Math.min(this.Wb,c);this.Tb=Math.max(this.Tb,c);this.od=[(this.Ub+this.Rb)/2,(this.Vb+this.Sb)/2,(this.Wb+this.Tb)/2];this.Cf=s;this.e=q;this.Q[this.F++]=a;this.Q[this.F++]=b;this.Q[this.F++]=c;return this.F/3};w.ob=function(){if(this.F!=this.Q.length){var a=new Float32Array(this.F);a.set(this.Q.subarray(0,this.F));this.Q=a}};
w.get=function(a){a*=3;return[this.Q[a],this.Q[a+1],this.Q[a+2]]};w.remove=function(){l(Error("Not implemented."))};w.clear=function(){this.Q=new Float32Array(this.Q.length);this.e=q};W.prototype.__defineGetter__("count",function(){this.ob();return this.Q.length/3});W.prototype.__defineGetter__("length",function(){this.ob();return this.Q.length});C("X.triplets",W);C("X.triplets.prototype.add",W.prototype.add);C("X.triplets.prototype.resize",W.prototype.ob);C("X.triplets.prototype.get",W.prototype.get);
C("X.triplets.prototype.remove",W.prototype.remove);C("X.triplets.prototype.clear",W.prototype.clear);function Tc(){this.oa=Uc;this.Pa=new Qc;this.Ob=[1,1,1];this.xc=this.za=this.Z=this.k=this.j=r;this.qc=[];this.sa=q;this.oc=this.Sc=1;this.ic=r;this.Kc=s;this.ba=1;this.O=0;this.Rc=q}var Uc="TRIANGLES";Tc.prototype.__defineSetter__("type",function(a){return this.oa=a});Tc.prototype.__defineGetter__("type",t("oa"));Tc.prototype.__defineGetter__("texture",function(){this.za||(this.za=new Sc);return this.za});Tc.prototype.__defineGetter__("transform",t("Pa"));Tc.prototype.__defineGetter__("points",t("j"));
Tc.prototype.__defineSetter__("points",ba("j"));Tc.prototype.__defineGetter__("normals",t("k"));Tc.prototype.__defineSetter__("normals",ba("k"));Tc.prototype.__defineGetter__("colors",t("Z"));Tc.prototype.__defineSetter__("colors",ba("Z"));Tc.prototype.__defineGetter__("color",t("Ob"));Tc.prototype.__defineSetter__("color",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid color."));for(var b=this.h,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Ob=a;this.e=q});
Tc.prototype.__defineGetter__("opacity",t("ba"));Tc.prototype.__defineSetter__("opacity",function(a){(!y(a)||1<a||0>a)&&l(Error("Invalid opacity."));for(var b=this.h,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.ba=a;this.e=q});Tc.prototype.__defineGetter__("caption",t("ic"));Tc.prototype.__defineSetter__("caption",function(a){this.ic=a;this.e=q});Tc.prototype.__defineGetter__("visible",t("sa"));
Tc.prototype.__defineSetter__("visible",function(a){for(var b=this.h,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.sa=a;this.e=q});Tc.prototype.__defineGetter__("pointsize",t("Sc"));Tc.prototype.__defineSetter__("pointsize",function(a){y(a)||l(Error("Invalid point size."));this.Sc=a;this.e=q});Tc.prototype.__defineGetter__("magicmode",t("Kc"));Tc.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&l(Error("Invalid magic mode setting."));this.Kc=a;this.e=q});
Tc.prototype.__defineGetter__("linewidth",t("oc"));Tc.prototype.__defineSetter__("linewidth",function(a){y(a)||l(Error("Invalid line width."));this.oc=a;this.e=q});Tc.prototype.__defineGetter__("pickable",t("Rc"));Tc.prototype.__defineSetter__("pickable",function(a){"boolean"!=typeof a&&l(Error("Invalid pickable setting."));this.Rc=a;this.e=q});Tc.prototype.__defineGetter__("textureCoordinateMap",t("xc"));Tc.prototype.__defineSetter__("textureCoordinateMap",ba("ak"));function Vc(){this.Na=Infinity;this.U=this.$=-Infinity;this.V=Infinity;this.Cb=[0,0,0];this.Ab=[1,1,1]}Vc.prototype.__defineGetter__("lowerThreshold",t("U"));Vc.prototype.__defineSetter__("lowerThreshold",ba("U"));Vc.prototype.__defineGetter__("upperThreshold",t("V"));Vc.prototype.__defineSetter__("upperThreshold",ba("V"));Vc.prototype.__defineGetter__("min",t("Na"));Vc.prototype.__defineGetter__("max",t("$"));Vc.prototype.__defineGetter__("minColor",t("Cb"));
Vc.prototype.__defineSetter__("minColor",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid min. color."));this.Cb=a});Vc.prototype.__defineGetter__("maxColor",t("Ab"));Vc.prototype.__defineSetter__("maxColor",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid max. color."));this.Ab=a});function Wc(){M.call(this);this.c="scalars";this.Fc=this.u=r;this.Of=q;this.le=0;Fa(this,new uc);Fa(this,new Vc);this.Cb=[0,1,0];this.Ab=[1,0,0]}D(Wc,M);Wc.prototype.__defineGetter__("array",t("u"));Wc.prototype.__defineSetter__("array",function(a){this.Fc=this.u=a;this.e=q});Wc.prototype.__defineGetter__("interpolation",t("le"));Wc.prototype.__defineSetter__("interpolation",ba("le"));C("X.scalars",Wc);function Y(a){M.call(this);this.c="object";this.h=[];this.w=this.gb=r;Fa(this,new Tc);a!=r&&this.Zb(a)}D(Y,M);
Y.prototype.Zb=function(a){this.oa=a.oa;this.Pa=new Qc;this.Pa.ha=new Float32Array(a.Pa.ha);this.Ob=a.Ob.slice();a.j&&(this.j=new W(a.j.length,a.j));a.k&&(this.k=new W(a.k.length,a.k));a.Z&&(this.Z=new W(a.Z.length,a.Z));this.za=a.za;this.xc=a.xc;a.m&&(this.m=new tc((new String(a.m.xd)).toString()));this.ba=a.ba;this.h.length=0;var b=a.h;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.h.push(new I[b[d].c](b[d]));this.sa=a.sa;this.Sc=a.Sc;this.oc=a.oc;a.ic&&(this.ic=(new String(a.ic)).toString());this.Kc=
a.Kc;this.Rc=a.Rc;this.qc=a.qc.slice();this.e=q};Y.prototype.__defineGetter__("colortable",function(){this.gb||(this.gb=new Ac);return this.gb});Y.prototype.__defineGetter__("scalars",function(){this.w||(this.w=new Wc);return this.w});Y.prototype.__defineGetter__("children",t("h"));Y.prototype.l=function(){var a=new Xc;a.aa=this;this.dispatchEvent(a)};
function Yc(a,b){(a==r||b==r||!(a instanceof Y)||!(b instanceof Y))&&l(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.ba?-1:1==b.ba?1:a.O!=r&&b.O!=r&&a.O>b.O?-1:1}C("X.object",Y);C("X.object.prototype.modified",Y.prototype.l);function Zc(){}function $c(a){for(var b=a.j.count,c=[],d=0,d=0;d<b;d+=3){var e=a.j.get(d),f=a.j.get(d+1),g=a.j.get(d+2),h=a.k.get(d),j=a.k.get(d+1),k=a.k.get(d+2),m=a.Ob;a.Z&&0<a.Z.length&&(m=a.Z.get(d));var p=[];p.push(new gc(e,h));p.push(new gc(f,j));p.push(new gc(g,k));c.push(new ic(p,m))}return rc(c)}
function ad(a,b){(b==r||!(b instanceof qc))&&l(Error("Invalid CSG object."));var c=new sc,d=[];Hb(b.I,function(a){var b=[],g=a.fe,b=Hb(a.qb,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.fh=Hb(c.unique(),function(a){return[a.Ea.x(),a.Ea.y(),a.Ea.b()]});a.eh=Hb(c.unique(),function(a){return[a.ea.x(),a.ea.y(),a.ea.b()]});a.dh=Hb(c.unique(),function(a){return!a.color?r:[a.color[0],a.color[1],a.color[2]]});a.j=new W(9*d.length);a.k=new W(9*d.length);
a.Z=new W(9*d.length);Hb(d,function(a){var b=a[0],c=a[1];a=a[2];var d=this.fh,j=this.eh,k=this.dh;this.j.add(d[b][0],d[b][1],d[b][2]);this.j.add(d[c][0],d[c][1],d[c][2]);this.j.add(d[a][0],d[a][1],d[a][2]);this.k.add(j[b][0],j[b][1],j[b][2]);this.k.add(j[c][0],j[c][1],j[c][2]);this.k.add(j[a][0],j[a][1],j[a][2]);k[b]&&this.Z.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.Z.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.Z.add(k[a][0],k[a][1],k[a][2])}.bind(a));0==a.Z.F&&(a.Z=r);a.oa=Uc}
Zc.prototype.tf=function(a){(a==r||!(a instanceof qc)&&!(a instanceof Y))&&l(Error("Invalid object."));var b=a;a instanceof Y&&(b=$c(b));a=new Y;Fa(a,new Zc);ad(a,$c(this).tf(b));return a};Zc.prototype.pa=function(a){(a==r||!(a instanceof qc)&&!(a instanceof Y))&&l(Error("Invalid object."));var b=a;a instanceof Y&&(b=$c(b));a=new Y;Fa(a,new Zc);ad(a,$c(this).pa(b));return a};
Zc.prototype.Ue=function(a){(a==r||!(a instanceof qc)&&!(a instanceof Y))&&l(Error("Invalid object."));var b=a;a instanceof Y&&(b=$c(b));a=new Y;Fa(a,new Zc);ad(a,$c(this).Ue(b));return a};Zc.prototype.inverse=function(){var a=new Y;Fa(a,new Zc);ad(a,$c(this).inverse());return a};C("X.constructable",Zc);C("X.constructable.prototype.intersect",Zc.prototype.Ue);C("X.constructable.prototype.inverse",Zc.prototype.inverse);C("X.constructable.prototype.subtract",Zc.prototype.pa);
C("X.constructable.prototype.union",Zc.prototype.tf);function bd(a){Nb.call(this,a);this.c="event"}D(bd,Nb);var cd=ec("pan"),dd=ec("rotate"),ed=ec("zoom"),fd=ec("scroll");ec("render");var gd=ec("resetview"),hd=ec("windowlevel"),id=ec("modified"),jd=ec("progress"),kd=ec("hover"),ld=ec("hover_end");function md(){bd.call(this,hd);this.re=this.Fe=0}D(md,bd);function nd(){bd.call(this,cd);this.O=new I.f(0,0,0)}D(nd,bd);function od(){bd.call(this,dd);this.O=new I.f(0,0,0)}D(od,bd);function pd(){bd.call(this,ed);this.Ma=this.Xa=s}D(pd,bd);
function qd(){bd.call(this,fd);this.M=s}D(qd,bd);function rd(){bd.call(this,kd);this.Gd=this.Fd=0}D(rd,bd);function sd(){bd.call(this,ld)}D(sd,bd);function td(){bd.call(this,gd)}D(td,bd);function Xc(){bd.call(this,id);this.v=this.aa=r}D(Xc,bd);function ud(){bd.call(this,jd);this.Sf=0}D(ud,bd);function vd(a,b,c){a==r&&l(Error("Invalid GL Buffer."));b==r&&l(Error("Invalid number of items."));c==r&&l(Error("Invalid item size."));M.call(this);this.c="buffer";this.B=a;this.xb=b;this.yb=c}D(vd,M);function wd(a,b){this.x=ga(a)?a:0;this.y=ga(b)?b:0}w=wd.prototype;w.g=function(){return new wd(this.x,this.y)};function xd(a,b){return new wd(a.x-b.x,a.y-b.y)}w.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};w.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};w.translate=function(a,b){a instanceof wd?(this.x+=a.x,this.y+=a.y):(this.x+=a,y(b)&&(this.y+=b));return this};w.scale=function(a,b){var c=y(b)?b:a;this.x*=a;this.y*=c;return this};function yd(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}w=yd.prototype;w.g=function(){return new yd(this.top,this.right,this.bottom,this.left)};w.contains=function(a){return!this||!a?s:a instanceof yd?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};
w.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};w.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};w.translate=function(a,b){a instanceof wd?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,y(b)&&(this.top+=b,this.bottom+=b));return this};
w.scale=function(a,b){var c=y(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};function zd(a,b){this.width=a;this.height=b}zd.prototype.g=function(){return new zd(this.width,this.height)};zd.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};zd.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};zd.prototype.scale=function(a,b){var c=y(b)?b:a;this.width*=a;this.height*=c;return this};function Ad(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}w=Ad.prototype;w.g=function(){return new Ad(this.left,this.top,this.width,this.height)};w.mg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,q}return s};
w.contains=function(a){return a instanceof Ad?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};function Bd(a,b){var c=b.x<a.left?a.left-b.x:Math.max(b.x-(a.left+a.width),0),d=b.y<a.top?a.top-b.y:Math.max(b.y-(a.top+a.height),0);return c*c+d*d}w.kb=function(a){return Math.sqrt(Bd(this,a))};
w.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};w.translate=function(a,b){a instanceof wd?(this.left+=a.x,this.top+=a.y):(this.left+=a,y(b)&&(this.top+=b));return this};
w.scale=function(a,b){var c=y(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};var Cd;function Dd(a,b){var c;c=a.className;c=ma(c)&&c.match(/\S+/g)||[];for(var d=Kb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Fb(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};var Ed=!L||L&&9<=Bb;!lb&&!L||L&&L&&9<=Bb||lb&&yb("1.9.1");L&&yb("9");function Fd(a){return a?new Gd(Hd(a)):Cd||(Cd=new Gd)}function Id(a){return ma(a)?document.getElementById(a):a}var Jd={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Kd(a,b,c){return Ld(document,arguments)}
function Ld(a,b){var c=b[0],d=b[1];if(!Ed&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Qa(d.name),'"');if(d.type){c.push(' type="',Qa(d.type),'"');var e={};Pa(e,d);delete e.type;d=e}c.push(">");c=c.join("")}var f=a.createElement(c);if(d)if(ma(d))f.className=d;else if(ka(d))Dd.apply(r,[f].concat(d));else{var c=function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in Jd?f.setAttribute(Jd[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?
f.setAttribute(b,a):f[b]=a},g;for(g in d)c.call(n,d[g],g)}if(2<b.length){g=function(b){b&&f.appendChild(ma(b)?a.createTextNode(b):b)};for(d=2;d<b.length;d++)if(e=b[d],la(e)&&!(oa(e)&&0<e.nodeType)){var c=Gb,h;a:{if((h=e)&&"number"==typeof h.length){if(oa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(na(h)){h="function"==typeof h.item;break a}}h=s}if(h)if(h=e.length,0<h){for(var j=Array(h),k=0;k<h;k++)j[k]=e[k];e=j}else e=[];c(e,g)}else g(e)}return f}
function Md(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function Nd(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Pd(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Hd(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function Gd(a){this.R=a||da.document||document}w=Gd.prototype;w.Od=Fd;
w.n=function(a){return ma(a)?this.R.getElementById(a):a};w.Yg=Gd.prototype.n;w.Ac=function(a,b,c){return Ld(this.R,arguments)};w.createElement=function(a){return this.R.createElement(a)};w.createTextNode=function(a){return this.R.createTextNode(String(a))};function Qd(a){return"CSS1Compat"==a.R.compatMode}
function Rd(a){var b=a.R;a=!mb&&"CSS1Compat"==b.compatMode?b.documentElement:b.body;b=b.parentWindow||b.defaultView;return L&&yb("10")&&b.pageYOffset!=a.scrollTop?new wd(a.scrollLeft,a.scrollTop):new wd(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}w.appendChild=function(a,b){a.appendChild(b)};w.contains=Pd;function Sd(a,b){var c=Hd(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,r))?c[b]||c.getPropertyValue(b)||"":""}function Td(a,b){return Sd(a,b)||(a.currentStyle?a.currentStyle[b]:r)||a.style&&a.style[b]}function Ud(a){a=a?Hd(a):document;return L&&!(L&&9<=Bb)&&!Qd(Fd(a))?a.body:a.documentElement}
function Vd(a){var b=a.getBoundingClientRect();L&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function Wd(a){if(L&&!(L&&8<=Bb))return a.offsetParent;var b=Hd(a),c=Td(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Td(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return r}
function Xd(a){for(var b=new yd(0,Infinity,Infinity,0),c=Fd(a),d=c.R.body,e=c.R.documentElement,f=!mb&&"CSS1Compat"==c.R.compatMode?c.R.documentElement:c.R.body;a=Wd(a);)if((!L||0!=a.clientWidth)&&(!mb||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=Td(a,"overflow")){var g=Yd(a),h;h=a;if(lb&&!yb("1.9")){var j=parseFloat(Sd(h,"borderLeftWidth"));if(Zd(h))var k=h.offsetWidth-h.clientWidth-j-parseFloat(Sd(h,"borderRightWidth")),j=j+k;h=new wd(j,parseFloat(Sd(h,"borderTopWidth")))}else h=new wd(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(c.R.parentWindow||c.R.defaultView||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new zd(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&
b.bottom>b.top&&b.right>b.left?b:r}
function Yd(a){var b,c=Hd(a),d=Td(a,"position"),e=lb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new wd(0,0),g=Ud(c);if(a==g)return f;if(a.getBoundingClientRect)b=Vd(a),a=Rd(Fd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(mb&&"fixed"==Td(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(kb||mb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=Wd(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!kb||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function $d(a){var b=new wd;if(1==a.nodeType){if(a.getBoundingClientRect){var c=Vd(a);b.x=c.left;b.y=c.top}else{var c=Rd(Fd(a)),d=Yd(a);b.x=d.x-c.x;b.y=d.y-c.y}if(lb&&!yb(12)){var e;L?e="-ms-transform":mb?e="-webkit-transform":kb?e="-o-transform":lb&&(e="-moz-transform");var f;e&&(f=Td(a,e));f||(f=Td(a,"transform"));f?(a=f.match(ae),a=!a?new wd(0,0):new wd(parseFloat(a[1]),parseFloat(a[2]))):a=new wd(0,0);b=new wd(b.x+a.x,b.y+a.y)}}else e=na(a.Lh),f=a,a.targetTouches?f=a.targetTouches[0]:e&&a.Sa.targetTouches&&
(f=a.Sa.targetTouches[0]),b.x=f.clientX,b.y=f.clientY;return b}function be(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function ce(a){if("none"!=Td(a,"display"))return de(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=de(a);b.display=c;b.position=e;b.visibility=d;return a}
function de(a){var b=a.offsetWidth,c=a.offsetHeight,d=mb&&!b&&!c;return(!ga(b)||d)&&a.getBoundingClientRect?(a=Vd(a),new zd(a.right-a.left,a.bottom-a.top)):new zd(b,c)}function ee(a,b){a.style.display=b?"":"none"}function Zd(a){return"rtl"==Td(a,"direction")}function fe(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}
function ge(a,b){var c=a.currentStyle?a.currentStyle[b]:r;return c?fe(a,c):0}var he={thin:2,medium:4,thick:6};function ie(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:r))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:r;return c in he?he[c]:fe(a,c)}var ae=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function je(a,b){fc.call(this);this.s=a;var c=oa(this.s)&&1==this.s.nodeType?this.s:this.s?this.s.body:r;this.di=!!c&&Zd(c);this.ik=Vb(this.s,lb?"DOMMouseScroll":"mousewheel",this,b)}D(je,fc);
je.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.Sa;if("mousewheel"==a.type){c=1;if(L||mb&&(bb||yb("532.0")))c=40;d=ke(-a.wheelDelta,c);ga(a.wheelDeltaX)?(b=ke(-a.wheelDeltaX,c),c=ke(-a.wheelDeltaY,c)):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ga(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;y(this.sg)&&(b=Math.min(Math.max(b,-this.sg),this.sg));y(this.tg)&&(c=Math.min(Math.max(c,-this.tg),this.tg));this.di&&(b=-b);b=new le(d,a,b,c);this.dispatchEvent(b)};
function ke(a,b){return mb&&(ab||cb)&&0!=a%b?a:a/b}function le(a,b,c,d){b&&this.ka(b,n);this.type="mousewheel";this.detail=a;this.ek=c;this.Bc=d}D(le,Pb);L||mb&&yb("525");function me(a){M.call(this);this.c="interactor";this.wa=a;this.se=this.Hf=this.Gf=this.If=this.Ff=this.Jf=r;this.vd=q;this.Gb=this.Bb=this.Ya=s;this.hb=[0,0];this.ne=new I.f(0,0,0);this.Jc=new I.f(0,0,0);this.og=0;this.Rf=this.rd=r;this.Pf=s;this.J={MOUSEWHEEL_ENABLED:s,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:s,TOUCH_ENABLED:q,TOUCH_BOUNCING_ENABLED:s}}D(me,M);me.prototype.__defineGetter__("config",t("J"));me.prototype.__defineGetter__("leftButtonDown",t("Ya"));
me.prototype.__defineGetter__("middleButtonDown",t("Bb"));me.prototype.__defineGetter__("rightButtonDown",t("Gb"));
me.prototype.ka=function(){this.J.MOUSEWHEEL_ENABLED?(this.se=new je(this.wa),this.Jf=Vb(this.se,"mousewheel",this.ed.bind(this))):($b(this.Jf),this.se=r);this.J.MOUSECLICKS_ENABLED?(this.Ff=Vb(this.wa,"mousedown",this.qi.bind(this)),this.If=Vb(this.wa,"mouseup",this.vi.bind(this))):($b(this.Ff),$b(this.If));this.wa.oncontextmenu=this.J.CONTEXTMENU_ENABLED?r:function(){return s};window.onkeydown=this.J.KEYBOARD_ENABLED?this.yg.bind(this):r;this.J.TOUCH_ENABLED?(this.J.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},s),this.mh=Vb(this.wa,"touchstart",this.Ii.bind(this)),this.lh=Vb(this.wa,"touchmove",this.Gi.bind(this)),this.kh=Vb(this.wa,"touchend",this.Ci.bind(this))):($b(this.mh),$b(this.lh),$b(this.kh));$b(this.Gf);$b(this.Hf);this.Gf=Vb(this.wa,"mousemove",this.si.bind(this));this.Hf=Vb(this.wa,"mouseout",this.ti.bind(this))};
me.prototype.qi=function(a){0==a.button?this.Ya=q:1==a.button?this.Bb=q:2==a.button&&(this.Gb=q);eval("this.onMouseDown("+this.Ya+","+this.Bb+","+this.Gb+")");ne(this);a.preventDefault()};me.prototype.pi=aa();me.prototype.vi=function(a){0==a.button?this.Ya=s:1==a.button?this.Bb=s:2==a.button&&(this.Gb=s);eval("this.onMouseUp("+this.Ya+","+this.Bb+","+this.Gb+")");ne(this);a.preventDefault()};me.prototype.__defineGetter__("mousePosition",t("hb"));w=me.prototype;w.ui=aa();
w.ti=function(a){this.vd=s;this.J.KEYBOARD_ENABLED&&(window.onkeydown=r);this.Gb=this.Bb=this.Ya=s;ne(this);this.ne=new I.f(0,0,0);a.preventDefault()};w.ri=aa();w.Ii=function(a){a.preventDefault();a.ka(a.Sa.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Jc=new I.f(a.clientX,a.clientY,0);this.Rf=setTimeout(this.Ei.bind(this,a),500)};w.Hi=aa();
w.Ei=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new pd;a.Xa=q;a.Ma=this instanceof oe;this.dispatchEvent(a);this.Cd=q};w.Di=aa();function pe(a){clearTimeout(a.Rf);if(a.Cd){var b=new pd;b.Xa=s;b.Ma=a instanceof oe;a.dispatchEvent(b)}a.Cd=s}w.Ci=function(a){a.preventDefault();eval("this.onTouchEnd()");pe(this)};w.Bi=aa();
w.Gi=function(a){a.preventDefault();this.Cd||pe(this);this.touchmoveEvent=a=a.Sa;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new I.f(c[0],c[1],0);var b=c[0]>3*this.wa.clientWidth/4,d=c[0]<this.wa.clientWidth/4,e=c[1]<this.wa.clientHeight/4,c=c[1]>3*this.wa.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.Jc.pa(a);this.Jc=a.g();if(this.Cd)a=new nd,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.O=e,this.dispatchEvent(a);
else if(this instanceof qe&&(b||d))a=new qd,a.M=0>e.y,this.dispatchEvent(a);else if(this instanceof oe||c)e.scale(3),a=new od,a.O=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new I.f(a[0],a[1],0),b=new I.f(b[0],b[1],0),e=Cc(a,b),b=e-this.og,this.og=e,this.Jc.pa(a),this.Jc=a.g(),10<Math.abs(b)&&(a=new pd,a.Xa=0<b,a.Ma=this instanceof oe,this.dispatchEvent(a)))};w.Fi=aa();
w.si=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.vd=q;this.J.KEYBOARD_ENABLED&&window.onkeydown==r&&(window.onkeydown=this.yg.bind(this));a.preventDefault();var b=a.shiftKey;this.Pf=b;this.hb=[a.offsetX,a.offsetY];var c=new I.f(this.hb[0],this.hb[1],0);a=this.ne.pa(c);this.ne=c.g();this.J.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.Bb||this.Ya||this.Gb)&&ne(this),this.rd=setTimeout(function(){ne(this);var a=new rd;a.Fd=c.x;a.Gd=c.y;this.dispatchEvent(a);
this.rd=r}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.mb()&&(this.Ya&&!b?(b=new od,a.scale(3),b.O=a,this.dispatchEvent(b)):this.Bb||this.Ya&&b?(b=new nd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.O=a,this.dispatchEvent(b)):this.Gb&&(b=new pd,b.Xa=0<a.y,b.Ma=s,this.dispatchEvent(b)))};function ne(a){a.rd&&clearTimeout(a.rd);a.dispatchEvent(new sd)}w.wi=aa();
w.ed=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");ne(this);a.preventDefault()};w.ni=aa();
w.yg=function(a){if(this.vd){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");ne(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new td,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new nd:b?a=new pd:(a=new od,this instanceof qe&&(a=new qd)),a&&(c=new I.f(0,0,0),37==f?(c.x=5,a.M=s,b&&(a.M=q,a.Xa=q,a.Ma=s)):39==f?(c.x=-5,a.M=q,b&&(a.Xa=s,a.Ma=s)):38==f?(c.y=5,a.M=q,b&&(a.Xa=q,a.Ma=q)):40==f&&(c.y=-5,a.M=s,b&&(a.Xa=
s,a.Ma=q)),a.O=c,this.dispatchEvent(a)))}};C("X.interactor",me);C("X.interactor.prototype.init",me.prototype.ka);C("X.interactor.prototype.onMouseDown",me.prototype.pi);C("X.interactor.prototype.onMouseUp",me.prototype.ui);C("X.interactor.prototype.onMouseMove",me.prototype.ri);C("X.interactor.prototype.onMouseWheel",me.prototype.wi);C("X.interactor.prototype.onKey",me.prototype.ni);C("X.interactor.prototype.onTouchStart",me.prototype.Hi);C("X.interactor.prototype.onTouchMove",me.prototype.Fi);
C("X.interactor.prototype.onTouchEnd",me.prototype.Bi);C("X.interactor.prototype.onTouchHover",me.prototype.Di);function qe(a){me.call(this,a);this.c="interactor2D"}D(qe,me);qe.prototype.ed=function(a){qe.q.ed.call(this,a);var b=new qd;a.Bc==r&&(a.Bc=0);b.M=0>a.Bc;this.dispatchEvent(b)};function re(a,b){(!y(a)||!y(b))&&l(Error("A camera needs valid width and height values."));M.call(this);this.c="camera";this.ya=new I.f(0,100,0);this.lc=new I.f(0,0,0);this.M=new I.f(0,0,1);this.p=this.Xd(this.ya,this.lc)}D(re,M);re.prototype.observe=function(a){(a==r||!(a instanceof me))&&l(Error("Could not observe the interactor."));Vb(a,dd,this.zi.bind(this));Vb(a,cd,this.xi.bind(this));Vb(a,ed,this.Li.bind(this))};
re.prototype.zi=function(a){a instanceof od||l(Error("Received no valid rotate event."));this.rotate(a.O)};re.prototype.Li=function(a){a instanceof pd||l(Error("Received no valid zoom event."));a.Xa?this.Wg(a.Ma):this.Xg(a.Ma)};re.prototype.xi=function(a){a instanceof nd||l(Error("Received no valid pan event."));this.Dg(a.O)};re.prototype.__defineGetter__("view",t("p"));re.prototype.__defineSetter__("view",function(a){(a==r||!(a instanceof Float32Array))&&l(Error("Invalid view matrix."));this.p=a});
re.prototype.__defineGetter__("position",function(){return[this.ya.x,this.ya.y,this.ya.b]});re.prototype.__defineSetter__("position",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid position."));this.ya=new I.f(a[0],a[1],a[2]);this.reset()});re.prototype.__defineGetter__("focus",function(){return[this.lc.x,this.lc.y,this.lc.b]});re.prototype.__defineSetter__("focus",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid focus"));this.lc=new I.f(a[0],a[1],a[2]);this.reset()});
re.prototype.__defineGetter__("up",function(){return[this.M.x,this.M.y,this.M.b]});re.prototype.__defineSetter__("up",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid up vector."));this.M=new I.f(a[0],a[1],a[2]);this.reset()});w=re.prototype;w.reset=function(){this.p=this.Xd(this.ya,this.lc)};w.rotate=function(a){ka(a)&&2==a.length?a=new I.f(a[0],a[1],0):a instanceof I.f||l(Error("Invalid distance vector for rotate operation."));return a};
w.Dg=function(a){ka(a)&&2==a.length?a=new I.f(a[0],a[1],0):a instanceof I.f||l(Error("Invalid distance vector for pan operation."));this.p[12]-=a.x;this.p[13]+=a.y};w.Wg=function(a){var b=20;a!=r&&!a&&(b=1);this.p[14]+=b};w.Xg=function(a){var b=30;a!=r&&!a&&(b=1);this.p[14]-=b};w.Xd=function(a,b){(!(a instanceof I.f)||!(b instanceof I.f))&&l(Error("3D vectors required for calculating the view."));return I.d.cd()};C("X.camera",re);C("X.camera.prototype.pan",re.prototype.Dg);
C("X.camera.prototype.rotate",re.prototype.rotate);C("X.camera.prototype.zoomIn",re.prototype.Wg);C("X.camera.prototype.zoomOut",re.prototype.Xg);function se(a,b){re.call(this,a,b);this.c="camera3D";this.Af=45;this.Lf=I.d.We(I.d.cd(),this.Af,a/b,1,1E4)}D(se,re);se.prototype.rotate=function(a){a=se.q.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new I.f(this.p[1],this.p[5],this.p[9]),d=new I.f(this.p[0],this.p[4],this.p[8]);c.normalize();d.normalize();I.d.rotate(this.p,b,c.x,c.y,c.b);I.d.rotate(this.p,a,d.x,d.y,d.b)};se.prototype.Xd=function(a,b){var c=se.q.Xd.call(this,a,b);I.d.rg(c,a,b,this.M);return c};
C("X.camera3D",se);function te(){M.call(this);this.c="parser";this.z=r;this.F=0;this.ih=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.sd=q;this.$j=-Infinity;this.Zj=Infinity}D(te,M);te.prototype.parse=function(){l(Error("The function parse() should be overloaded."))};function ue(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function ve(a,b,c){b===n&&(b=0);c===n&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function Z(a,b,c){c!=r||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array;d=4;break;case "complex":e=Float64Array;d=8;break;case "double":e=Float64Array,d=8}b=new e(a.z.slice(a.F,a.F+=c*d));if(a.ih!=a.sd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>
g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}function we(a,b){"right"!=a[0]&&(b[0]=-b[0],b[3]=-b[3],b[6]=-b[6]);"anterior"!=a[1]&&(b[1]=-b[1],b[4]=-b[4],b[7]=-b[7]);"superior"!=a[2]&&(b[2]=-b[2],b[5]=-b[5],b[8]=-b[8]);return b}
function xe(a,b){I.va(a.c+".orientnormalize");var c=b.slice(0,3),d=c.map(function(a){return Math.abs(a)}),e=d.indexOf(Math.max.apply(Math,d)),d=[0,0,0];d[e]=0>c[e]?-1:1;var f=b.slice(3,6),c=f.map(function(a){return Math.abs(a)}),g=c.indexOf(Math.max.apply(Math,c)),c=[0,0,0];c[g]=0>f[g]?-1:1;var f=b.slice(6,9),h=f.map(function(a){return Math.abs(a)}),j=h.indexOf(Math.max.apply(Math,h)),h=[0,0,0];h[j]=0>f[j]?-1:1;e=[d[e],c[g],h[j]];d=[d,c,h];I.qa(a.c+".orientnormalize");return[e,d]}
function Ae(a,b){I.va(a.c+".reslice");var c=b.P!=r,d=r;b.gb&&(d=b.gb.zb);for(var e=b.Ia,f=b.Hb,g=b.z,h=Array(e[2]),j=Array(e[2]),k=b.G,m=e[0]*e[1],p=0,u=0,x=0,v=0,z=0,v=0;v<e[2];v++){var F=g.subarray(v*m,(v+1)*m),z=0;h[v]=Array(e[1]);j[v]=Array(e[1]);for(x=0;x<e[1];x++){h[v][x]=new b.z.constructor(e[0]);j[v][x]=new b.z.constructor(e[0]);for(u=0;u<e[0];u++)p=F[z],h[v][x][u]=255*(p/b.$),j[v][x][u]=p,z++}}for(var E=0,g=g=0;3>g;g++){var H=g,v=(H+1)%3,h=(H+2)%3,m=4*e[H]*e[v],p=e[H],z=e[v],F=e[h],B=(F-
1)/2,G=k[H],J=k[v],U=k[h],N=[1,1,1],N=0!=k[h][2]?[1,0,0]:0!=k[h][1]?[0,1,0]:[1,1,0],H=p*f[H],K=z*f[v];0!=k[2][1]&&(v=H,H=K,K=v);for(v=0;v<F;v++){var O=0,R=-B*f[h]+v*f[h],x=[b.o[0]+k[h][0]*R,b.o[1]+k[h][1]*R,b.o[2]+k[h][2]*R],R=new Be,E=q;b.jb!=r&&!c&&(E=s);var u=R,S=U,V=J,ja=G,A=H,T=K,ha=E,E=N;(x==r||!ka(x)||3!=x.length)&&l(Error("Invalid center."));(S==r||!ka(S)||3!=S.length)&&l(Error("Invalid front direction."));(V==r||!ka(V)||3!=V.length)&&l(Error("Invalid up direction."));y(A)||l(Error("Invalid width."));
y(T)||l(Error("Invalid height."));var Da=s;ha!=r&&(Da=ha);ha=[1,1,1];E!=r&&(ha=E);u.o=x;u.mc=S;u.M=V;u.zd=ja;u.H=A;u.C=T;u.fb=Da;u.hc=ha;u.$b();R.jb=b;R.visible=s;S=new Uint8Array(m);for(x=0;x<z;x++)for(u=0;u<p;u++)E=0==g?j[v][x][u]:1==g?j[x][u][v]:j[u][v][x],T=A=ja=V=0,d?((T=d.get(Math.floor(E)))||(T=[0,1,0.1,0.2,1]),V=255*T[1],ja=255*T[2],A=255*T[3],T=255*T[4]):(V=ja=A=255*(E/b.$),T=255),E=4*O,S[E]=V,S[++E]=ja,S[++E]=A,S[++E]=T,O++;O=new Sc;O.Fb=S;O.xe=p;O.we=z;R.za=O;0<b.Oa[h]?b.h[g].h.push(R):
b.h[g].h.unshift(R);c&&(R.P=b.P.h[g].h[v].za)}0==g?(b.T=B,b.Gc=B):1==g?(b.ca=B,b.Hc=B):2==g&&(b.da=B,b.Ic=B);if(!b.ye)break}I.qa(a.c+".reslice");return j};function Ce(){te.call(this);this.c="parserIMAGE"}D(Ce,te);Ce.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||l(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;Yb(f,"load",this.Ni.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Ce.prototype.Ni=function(a,b,c){b.tb=a;b.Fb=r;a=new Xc;a.aa=c;a.v=b;this.dispatchEvent(a)};C("X.parserIMAGE",Ce);C("X.parserIMAGE.prototype.parse",Ce.prototype.parse);function De(a,b){re.call(this,a,b);this.c="camera2D"}D(De,re);De.prototype.rotate=function(a){a=De.q.rotate.call(this,a);var b=new md;0<a.x?b.Fe--:0>a.x&&b.Fe++;0<a.y?b.re++:0>a.y&&b.re--;this.dispatchEvent(b)};function Ee(){M.call(this);this.c="shaders";this.Dd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.Dd=a+="}\n";this.qd="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform vec4 labelmapColor;\n";a+="uniform float volumeLowerThreshold;\n";
a+="uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";
a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";
a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="         if (labelmapColor.a != -255.0) {\n";
a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n";a+="             if (labelmapOpacity < 1.0) {\n";a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="             } else {\n";a+="               textureSum = texture2;\n";a+="             }\n";a+="           }\n";a+="         } else {\n";a+="           if (labelmapOpacity < 1.0) {\n";a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="           } else {\n";
a+="             textureSum = texture2;\n";a+="           }\n";a+="         }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold) {\n";a+="       discard;\n";a+="     };\n";a+="   };\n";a+="   gl_FragColor = textureSum;\n";
a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";
a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.qd=a+="}\n"}D(Ee,M);
var Fe={Kj:"vertexPosition",Jj:"vertexNormal",Ij:"vertexColor",Mj:"vertexTexturePos",Lj:"vertexScalar"},Ge={Nj:"view",rj:"perspective",ij:"center",qj:"objectTransform",Ej:"useObjectColor",oj:"objectColor",Gj:"useScalars",Aj:"scalarsReplaceMode",xj:"scalarsMin",uj:"scalarsMax",yj:"scalarsMinColor",vj:"scalarsMaxColor",zj:"scalarsMinThreshold",wj:"scalarsMaxThreshold",tj:"scalarsInterpolation",sj:"pointSize",pj:"objectOpacity",nj:"normal",Fj:"usePicking",Hj:"useTexture",Dj:"useLabelMapTexture",lj:"labelmapOpacity",
kj:"labelmapColor",Bj:"textureSampler",Cj:"textureSampler2",Oj:"volumeLowerThreshold",Uj:"volumeUpperThreshold",Rj:"volumeScalarMin",Pj:"volumeScalarMax",Sj:"volumeScalarMinColor",Qj:"volumeScalarMaxColor",Wj:"volumeWindowLow",Vj:"volumeWindowHigh",Tj:"volumeTexture"};function Be(a){Y.call(this);this.c="slice";this.o=[0,0,0];this.mc=[0,0,1];this.M=[0,1,0];this.zd=[1,0,0];this.C=this.H=10;this.xc=[0,1,0,0,1,1,1,1,1,0,0,0];this.P=this.jb=r;this.fb=q;this.hc=[1,1,1];a!=r&&this.Zb(a)}D(Be,Y);Be.prototype.Zb=function(a){this.o=a.o.slice();this.mc=a.mc.slice();this.M=a.M.slice();this.H=a.H;this.C=a.C;this.jb=a.jb;this.P=a.P;this.fb=a.fb;this.hc=a.hc;this.hh=a.hh;Be.q.Zb.call(this,a)};Be.prototype.__defineSetter__("height",ba("C"));
Be.prototype.__defineSetter__("width",ba("H"));Be.prototype.create=function(){this.$b()};
Be.prototype.$b=function(){var a=new Q(this.mc[0],this.mc[1],this.mc[2]),b=new Q(this.M[0],this.M[1],this.M[2]),c=new Q(this.zd[0],this.zd[1],this.zd[2]),d=new Q(this.o[0],this.o[1],this.o[2]),e=new Q(1,1,1);if(1==a.x||-1==a.x)e=new Q(this.o[0],this.H/2,this.C/2);else if(1==a.y||-1==a.y)e=new Q(this.C/2,this.o[1],this.H/2);else if(1==a.b||-1==a.b)e=new Q(this.H/2,this.C/2,this.o[2]);var f=Dc(c.g().L(),b.g().L()),f=new Q(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Dc(c.g().L(),b),g=new Q(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Dc(c,b.g().L()),h=new Q(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var j=h,b=Dc(c,b),b=new Q(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.j=new W(18);this.k=new W(18);this.j.add(f.x,f.y,f.b);this.j.add(g.x,g.y,g.b);this.j.add(h.x,h.y,h.b);this.j.add(j.x,j.y,j.b);this.j.add(b.x,b.y,b.b);this.j.add(d.x,d.y,d.b);this.k.add(a.x,a.y,a.b);this.k.add(a.x,a.y,a.b);this.k.add(a.x,a.y,a.b);this.k.add(a.x,a.y,a.b);this.k.add(a.x,a.y,a.b);this.k.add(a.x,a.y,a.b);this.fb&&(a=new Y,a.j=new W(24),a.k=
new W(24),a.j.add(f.x,f.y,f.b),a.j.add(g.x,g.y,g.b),a.j.add(g.x,g.y,g.b),a.j.add(b.x,b.y,b.b),a.j.add(b.x,b.y,b.b),a.j.add(h.x,h.y,h.b),a.j.add(h.x,h.y,h.b),a.j.add(f.x,f.y,f.b),a.k.add(0,0,0),a.k.add(0,0,0),a.k.add(0,0,0),a.k.add(0,0,0),a.k.add(0,0,0),a.k.add(0,0,0),a.k.add(0,0,0),a.k.add(0,0,0),a.Ob=[this.hc[0],this.hc[1],this.hc[2]],a.oa="LINES",a.oc=2,this.h.push(a))};C("X.slice",Be);C("X.slice.prototype.create",Be.prototype.create);function P(a){Y.call(this);this.c="volume";this.o=[0,0,0];this.Ia=[10,10,10];this.Hb=[1,1,1];this.tb=[];this.ub=this.wb=this.vb=this.Ic=this.da=this.Hc=this.ca=this.Gc=this.T=0;this.kc=[10,10,10];this.uc=new Y;this.vc=new Y;this.wc=new Y;this.Ed=this.Qa=s;this.Jb=0;this.P=r;this.fb=q;this.X=Infinity;this.W=-Infinity;this.ye=q;this.Qf=["left","posterior","superior"];this.Ce=[1,0,0,0,1,0,0,0,1];this.ve=[-1,0,0,0,-1,0,0,0,1];this.Oa=[-1,-1,1];this.G=[[-1,0,0],[0,-1,0],[0,0,1]];this.$=0;this.z=r;Fa(this,
new uc);Fa(this,new Vc);a!=r&&this.Zb(a)}D(P,Y);P.prototype.Zb=function(a){this.o=a.o.slice();this.Ia=a.Ia.slice();this.Hb=a.Hb.slice();this.T=a.T;this.Gc=a.Gc;this.ca=a.ca;this.Hc=a.Hc;this.da=a.da;this.Ic=a.Ic;this.vb=a.vb;this.wb=a.wb;this.ub=a.ub;this.kc=a.kc.slice();this.uc=new Y(a.uc);this.vc=new Y(a.vc);this.wc=new Y(a.wc);this.Qf=a.ma;this.Ce=a.Ce;this.ve=a.ve;this.Oa=a.Oa;this.G=a.G;this.$=a.$;this.z=a.z;this.Qa=a.Qa;this.Ed=a.Ed;this.Jb=a.Jb;this.P=a.P;this.fb=a.fb;P.q.Zb.call(this,a)};
P.prototype.$b=function(a){this.h.length=0;this.uc.h.length=0;this.vc.h.length=0;this.wc.h.length=0;this.h.push(this.uc);this.h.push(this.vc);this.h.push(this.wc);this.Qf=a.ma;this.Ce=a.i;this.ve=a.La;this.Oa=a.orientation;this.G=a.nb;this.$=a.max;this.z=a.data;this.e=q};
P.prototype.A=function(){var a=this.G[2],b=this.Ia;0!=a[0]?(this.vb=this.T,this.wb=this.ca,this.ub=this.da,this.kc=[b[2],b[0],b[1]]):0!=a[1]?(this.vb=this.ca,this.wb=this.T,this.ub=this.da,this.kc=[b[0],b[2],b[1]]):(this.vb=this.ca,this.wb=this.da,this.ub=this.T,this.kc=b)};
P.prototype.l=function(a){a="undefined"!==typeof a?a:q;if(0<this.h.length){this.Qa!=this.Ed&&(this.Qa?(this.h[0].h[parseInt(this.T,10)].visible=s,this.h[1].h[parseInt(this.ca,10)].visible=s,this.h[2].h[parseInt(this.da,10)].visible=s):this.h[this.Jb].visible=s,this.e=q,this.Ed=this.Qa);if(!this.sa)return;if(this.Qa)He(this,this.Jb);else for(var b=0,b=0;3>b;b++){var c=this.h[b],d=0,e=0;0==b?(d=this.T,e=this.Gc,this.Gc=this.T):1==b?(d=this.ca,e=this.Hc,this.Hc=this.ca):2==b&&(d=this.da,e=this.Ic,this.Ic=
this.da);c.h[parseInt(e,10)].visible=s;c=c.h[parseInt(d,10)];c.visible=q;c.ba=1}}a&&P.q.l.call(this)};P.prototype.__defineGetter__("dimensions",t("Ia"));P.prototype.__defineGetter__("dimensionsRAS",t("kc"));P.prototype.__defineGetter__("volumeRendering",t("Qa"));P.prototype.__defineSetter__("volumeRendering",function(a){this.Qa=a;this.l(s)});P.prototype.__defineGetter__("visible",t("sa"));
P.prototype.__defineSetter__("visible",function(a){if(a)this.sa=a,this.l(s);else{for(var b=this.h,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.sa=a;this.e=q}});P.prototype.__defineGetter__("center",t("o"));P.prototype.__defineSetter__("center",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid center."));this.o=a});P.prototype.__defineGetter__("image",t("tb"));P.prototype.__defineGetter__("labelmap",function(){this.P||(this.P=new Ie(this));return this.P});
P.prototype.__defineGetter__("indexIS",function(){return this.ub=0!=this.G[2][2]?this.T:this.da});P.prototype.__defineSetter__("indexIS",function(a){y(a)&&(0!=this.G[2][2]?this.T=a:this.da=a,this.ub=a,this.l(s))});P.prototype.__defineGetter__("indexLR",function(){return this.vb=0!=this.G[2][0]?this.T:this.ca});P.prototype.__defineSetter__("indexLR",function(a){y(a)&&(0!=this.G[2][0]?this.T=a:this.ca=a,this.vb=a,this.l(s))});
P.prototype.__defineGetter__("indexPA",function(){return this.wb=0!=this.G[2][0]?this.ca:0!=this.G[2][1]?this.T:this.da});P.prototype.__defineSetter__("indexPA",function(a){y(a)&&(0!=this.G[2][0]?this.ca=a:0!=this.G[2][1]?this.T=a:this.da=a,this.wb=a,this.l(s))});P.prototype.__defineGetter__("indexX",t("T"));P.prototype.__defineSetter__("indexX",function(a){y(a)&&(0<=a&&a<this.uc.h.length)&&(this.T=a,this.l(s))});P.prototype.__defineGetter__("indexY",t("ca"));
P.prototype.__defineSetter__("indexY",function(a){y(a)&&(0<=a&&a<this.vc.h.length)&&(this.ca=a,this.l(s))});P.prototype.__defineGetter__("indexZ",t("da"));P.prototype.__defineSetter__("indexZ",function(a){y(a)&&(0<=a&&a<this.wc.h.length)&&(this.da=a,this.l(s))});P.prototype.__defineGetter__("windowLow",t("X"));P.prototype.__defineSetter__("windowLow",ba("X"));P.prototype.__defineGetter__("windowHigh",t("W"));P.prototype.__defineSetter__("windowHigh",ba("W"));
P.prototype.__defineGetter__("borders",t("fb"));P.prototype.__defineSetter__("borders",ba("fb"));P.prototype.__defineGetter__("reslicing",t("ye"));P.prototype.__defineSetter__("reslicing",ba("ye"));function He(a,b){var c=(b+2)%3,c=0!=a.G[0][c]?2:0!=a.G[1][c]?0:1;0!=a.G[2][1]&&(c=(c+1)%3);if(a.Qa&&(a.e||c!=a.Jb)){var d=a.h[a.Jb];d.visible=s;var d=a.h[c],e=d.h.length,f;for(f=0;f<e;f++)d.h[f].sa=q;a.Jb=c;a.e=s}}C("X.volume",P);C("X.volume.prototype.modified",P.prototype.l);function Je(){te.call(this);this.c="parserSTL"}D(Je,te);
Je.prototype.parse=function(a,b,c){I.va(this.c+".parse");this.z=c;var d=b.j,e=b.k;if("solid"==ve(Z(this,"uchar",5))){b.j=d=new W(c.byteLength);b.k=e=new W(c.byteLength);var f=d,d=e,e=Z(this,"uchar",c.byteLength-5);c=e.length;var g=s,h=s,j=0,k;for(k=0;k<c;k++)if(10==e[k]){if(g||h){var m=ve(e,j,k).split(" "),h=parseFloat(m[0]),p=parseFloat(m[1]),m=parseFloat(m[2]);g?(d.add(h,p,m),d.add(h,p,m),d.add(h,p,m)):f.add(h,p,m);h=g=s}}else 32==e[k-1]&&(102==e[k]?(j=k+=13,g=q):118==e[k]&&(j=k+=7,h=q))}else{this.F=
80;f=Z(this,"uint");b.j=d=new W(9*f);b.k=e=new W(9*f);for(c=c=0;c<f;c++)g=Z(this,"float",12),j=g[0],k=g[1],h=g[2],e.add(j,k,h),e.add(j,k,h),e.add(j,k,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.F+=2}I.qa(this.c+".parse");f=new Xc;f.aa=b;f.v=a;this.dispatchEvent(f)};C("X.parserSTL",Je);C("X.parserSTL.prototype.parse",Je.prototype.parse);function Ke(){te.call(this);this.c="parserDCM"}D(Ke,te);
Ke.prototype.parse=function(a,b,c){c=this.gd(c,b);if(c.Vd==c.$a){var d=c.of.length,e,f=0;for(e=0;e<d;e++){var g=c.of[e];g!==n&&(g*=c.eb,c.data.set(c.$c.subarray(g,g+c.eb),f*c.eb),f++)}b.Ia=[c.Ba[0],c.Ba[1],c.Ba[2]];Infinity==c.t[2]&&(c.t[2]=1);b.Hb=[c.t[0],c.t[1],c.t[2]];e=ue(c.data);d=e[0];e=e[1];c.min=b.Na=b.X=d;c.max=b.$=b.W=e;-Infinity==b.U&&(b.U=d);Infinity==b.V&&(b.V=e);c.ma=["left","posterior","superior"];d=Ec(new Q(c.i[0],c.i[1],c.i[2]),new Q(c.i[3],c.i[4],c.i[5]));c.i.push(d.x,d.y,d.b);c.La=
we(c.ma,c.i);d=xe(this,c.La);c.orientation=d[0];c.nb=d[1];b.$b(c);b.tb=Ae(this,b);b.A()}c=new Xc;c.aa=b;c.v=a;this.dispatchEvent(c)};
Ke.prototype.gd=function(a,b){this.z=a;var c=0;if(b.gc!=r){g=b.gc;h=Z(this,"ushort",this.z.byteLength-2*g.eb);j=0;for(k=2;0<k;)if(d=h[j++],32==d)if(f=h[j++],19==f){j++;d=h[j++];for(f=0;f<d/2;f++)m=h[j++],p=m&255,m=(m&65280)>>8,c+=String.fromCharCode(p),c+=String.fromCharCode(m),c=parseInt(c,10);k--}else if(4161==f){j++;for(var d=h[j++],e="",f=0;f<d/2;f++)m=h[j++],p=m&255,m=(m&65280)>>8,e+=String.fromCharCode(p),e+=String.fromCharCode(m);g.t=[g.t[0],g.t[1],Math.min(Math.abs(g.qg-e),g.t[2])];g.qg=e;
k--}g.Ba[2]++}else{var g={rows:0,cols:0,t:r,He:0,rh:0,$a:1,li:1,qg:r,Vd:0,eb:0,$c:r,gf:0,of:[],data:r,min:Infinity,max:-Infinity,origin:r,ma:r,i:r,La:r,orientation:r,nb:r};g.$a=b.m.length;g.$a==r&&(g.$a=1);for(var h=Z(this,"ushort",this.z.byteLength),j=66,d=r,f=r,d=r,k=9;0<k;)if(d=h[j++],40==d)switch(f=h[j++],j++,d=h[j++],f){case 16:g.rows=h[j++];k--;break;case 17:g.cols=h[j++];k--;break;case 256:g.He=h[j++];k--;break;case 257:g.rh=h[j++];k--;break;case 2:g.li=h[j++];k--;break;case 48:e="";for(f=
f=0;f<d/2;f++)var m=h[j++],p=m&255,m=(m&65280)>>8,e=e+String.fromCharCode(p),e=e+String.fromCharCode(m);e=e.split("\\");g.t=[+e[0],+e[1],Infinity];k--}else if(32==d)switch(f=h[j++],j++,d=h[j++],f){case 19:for(f=0;f<d/2;f++)m=h[j++],p=m&255,m=(m&65280)>>8,c+=String.fromCharCode(p),c+=String.fromCharCode(m),c=parseInt(c,10);k--;break;case 50:e="";for(f=0;f<d/2;f++)m=h[j++],p=m&255,m=(m&65280)>>8,e+=String.fromCharCode(p),e+=String.fromCharCode(m);e=e.split("\\");g.origin=[+e[0],+e[1],+e[2]];k--;break;
case 55:e="";for(f=0;f<d/2;f++)m=h[j++],p=m&255,m=(m&65280)>>8,e+=String.fromCharCode(p),e+=String.fromCharCode(m);e=e.split("\\");g.i=[+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]];k--}else if(16==d)switch(f=h[j++],j++,d=h[j++],f){case 8720:for(f=0;f<d/2;f++)j++}b.gc=g;g.Ba=[g.cols,g.rows,1];g.eb=g.rows*g.cols;switch(g.He){case 8:g.$c=new Uint8Array(g.cols*g.rows*g.$a);g.data=new Uint8Array(g.cols*g.rows*g.$a);break;case 16:g.$c=new Uint16Array(g.cols*g.rows*g.$a);g.data=new Uint16Array(g.cols*g.rows*g.$a);
break;case 32:g.$c=new Uint32Array(g.cols*g.rows*g.$a),g.data=new Uint32Array(g.cols*g.rows*g.$a)}}this.F=this.z.byteLength-2*g.eb;h=r;switch(g.He){case 8:h=Z(this,"uchar",g.eb);break;case 16:h=Z(this,"ushort",g.eb);break;case 32:h=Z(this,"uint",g.eb)}g.of[c]=g.gf;g.$c.set(h,g.gf*g.eb);g.gf++;++g.Vd;return g};C("X.parserDCM",Ke);C("X.parserDCM.prototype.parse",Ke.prototype.parse);function Le(){te.call(this);this.c="parserVTK"}D(Le,te);
Le.prototype.parse=function(a,b,c){I.va(this.c+".parse");var d=b.j,e=b.k,f=new Uint8Array(c),g="";b.j=d=new W(c.byteLength);b.k=e=new W(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=ve(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.Wc=this.Xc=r;this.Qb=[];this.xa=Uc;this.te=this.Db=this.sb=this.Eb=s;c=0;for(h=g%8;h--;)Me(this,f[c]),c++;for(h=0.125*g^0;h--;)Me(this,f[c]),c++,Me(this,f[c]),c++,Me(this,f[c]),c++,Me(this,f[c]),c++,Me(this,f[c]),c++,Me(this,f[c]),c++,Me(this,f[c]),c++,
Me(this,f[c]),c++;c=this.Xc;var f=this.Wc,g=f.length,j=h=this.Qb.length;do{var k=this.Qb[h-j],m=k.length,p;for(p=0;p<m&&!("LINES"==this.xa&&p+1>=m);p++){var u=parseInt(k[p],10),x=c.get(u);d.add(x[0],x[1],x[2]);var v=u,z=x;"LINES"==this.xa?(v=parseInt(k[p+1],10),z=c.get(v),d.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.xa&&(0==p||p==m-1)&&d.add(x[0],x[1],x[2]);u<g?(z=f.get(u),e.add(z[0],z[1],z[2]),"LINES"==this.xa?(v=f.get(v),e.add(v[0],v[1],v[2])):"TRIANGLE_STRIPS"==this.xa&&(0==p||p==m-1)&&e.add(z[0],
z[1],z[2])):(v=new Q(x[0],x[1],x[2]),v.normalize(),e.add(v.x,v.y,v.b),"LINES"==this.xa?(v=new Q(z[0],z[1],z[2]),v.normalize(),e.add(v.x,v.y,v.b)):"TRIANGLE_STRIPS"==this.xa&&(0==p||p==m-1)&&e.add(v.x,v.y,v.b))}j--}while(0<j);b.oa=this.xa;I.qa(this.c+".parse");d=new Xc;d.aa=b;d.v=a;this.dispatchEvent(d)};
function Me(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.Eb=q;a.sb=s;a.Db=s;c=parseInt(c[1],10);a.Xc=new W(3*c);a.Wc=new W(3*c);return;case "VERTICES":a.sb=q;a.Eb=s;a.Db=s;c=parseInt(c[1],10);3<=c?a.xa=Uc:1==c?a.xa="POINTS":l(Error("This VTK file is not supported!"));a.Qb=[];return;case "TRIANGLE_STRIPS":a.sb=q;a.Eb=s;a.Db=s;a.xa="TRIANGLE_STRIPS";a.Qb=[];return;case "LINES":a.sb=q;a.Eb=s;a.Db=s;a.xa="LINES";a.Qb=[];return;case "POLYGONS":a.sb=q;
a.Eb=s;a.Db=s;a.xa="POLYGONS";a.Qb=[];return;case "POINT_DATA":a.Db=q;a.Eb=s;a.sb=s;return}if(a.Eb)if(1==d||isNaN(parseFloat(e)))a.Eb=s;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Xc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Xc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Xc.add(d,e,c))}else a.sb?1==d||isNaN(parseFloat(e))?a.sb=s:(c=c.slice(1),a.Qb.push(c)):a.Db&&("NORMALS"==e?a.te=q:1==d||isNaN(parseFloat(e))?
(a.Db=s,a.te=s):a.te&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Wc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Wc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Wc.add(d,e,c))))}C("X.parserVTK",Le);C("X.parserVTK.prototype.parse",Le.prototype.parse);function Ne(){te.call(this);this.c="parserFSM";this.sd=s}D(Ne,te);
Ne.prototype.parse=function(a,b,c){I.va(this.c+".parse");this.z=c;var d=b.j,e=b.k;b.qc=[];var f=b.qc;c=0;var g;do g=Z(this,"uchar"),c++;while(200>c&&10!=g);Z(this,"uchar");e=Z(this,"uint");c=Z(this,"uint");var h=Z(this,"float",3*e);g=Z(this,"uint",3*c);var j=new Uint32Array(e),k=new Float32Array(9*c);b.j=d=new W(9*c);b.k=e=new W(9*c);var m;for(m=0;m<c;m++){var p=3*m,u=g[p],x=g[p+1],v=g[p+2];f.push(u);f.push(x);f.push(v);j[u]+=1;j[x]+=1;j[v]+=1;var p=3*u,z=3*x,F=3*v,E=h[p],H=h[p+1],B=h[p+2],x=h[z],
v=h[z+1],u=h[z+2],G=h[F],J=h[F+1],U=h[F+2];d.add(E,H,B);d.add(x,v,u);d.add(G,J,U);E=new Q(E,H,B);G=new Q(G,J,U);x=(new Q(x,v,u)).g().pa(E);v=G.g().pa(E);x=Ec(x,v).normalize();k[p]+=x.x;k[p+1]+=x.y;k[p+2]+=x.b;k[z]+=x.x;k[z+1]+=x.y;k[z+2]+=x.b;k[F]+=x.x;k[F+1]+=x.y;k[F+2]+=x.b}for(m=0;m<c;m++)p=3*m,u=g[p],x=g[p+1],v=g[p+2],p=3*u,z=3*x,F=3*v,f=new Q(k[z],k[z+1],k[z+2]),h=new Q(k[F],k[F+1],k[F+2]),p=(new Q(k[p],k[p+1],k[p+2])).scale(1/j[u]).normalize(),f=f.scale(1/j[x]).normalize(),h=h.scale(1/j[v]).normalize(),
e.add(p.x,p.y,p.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);c=Z(this,"uchar",this.z.byteLength-this.F);g=r;for(p=0;p<c.length;p++)if(99==c[p]&&114==c[p+1]&&97==c[p+2]&&115==c[p+3]){for(e=g=p+9;10!=c[p]&&p<c.length;)e++,p++;g=ve(c.subarray(g,e)).split(" ");break}g&&(b.Pa.Qg(parseFloat(g[0])),b.Pa.Rg(parseFloat(g[1])),b.Pa.Sg(parseFloat(g[2])));b.oa=Uc;I.qa(this.c+".parse");c=new Xc;c.aa=b;c.v=a;this.dispatchEvent(c)};C("X.parserFSM",Ne);C("X.parserFSM.prototype.parse",Ne.prototype.parse);var Oe={Le:function(a,b,c){return Oe.update(a,0,b,c)},update:function(a,b,c,d){var e=Oe.Zg,f="number"===typeof c?c:c=0;d="number"===typeof d?d:a.length;b^=4294967295;for(f=d&7;f--;++c)b=b>>>8^e[(b^a[c])&255];for(f=d>>3;f--;c+=8)b=b>>>8^e[(b^a[c])&255],b=b>>>8^e[(b^a[c+1])&255],b=b>>>8^e[(b^a[c+2])&255],b=b>>>8^e[(b^a[c+3])&255],b=b>>>8^e[(b^a[c+4])&255],b=b>>>8^e[(b^a[c+5])&255],b=b>>>8^e[(b^a[c+6])&255],b=b>>>8^e[(b^a[c+7])&255];return(b^4294967295)>>>0}};
Oe.Zg=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Pe(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,j,k,m,p,u;for(p=0;p<b;++p)a[p]>c&&(c=a[p]),a[p]<d&&(d=a[p]);e=1<<c;f=new Uint32Array(e);g=1;h=0;for(j=2;g<=c;){for(p=0;p<b;++p)if(a[p]===g){k=0;m=h;for(u=0;u<g;++u)k=k<<1|m&1,m>>=1;for(u=k;u<e;u+=j)f[u]=g<<16|p;++h}++g;h<<=1;j<<=1}return[f,c,d]};function Qe(a,b){this.Ie=[];this.Je=32768;this.Ra=this.Yc=this.la=this.rf=0;this.input=new Uint8Array(a);this.Uf=s;this.Ke=Re;this.ob=s;if(b||!(b={}))b.index&&(this.la=b.index),b.bufferSize&&(this.Je=b.bufferSize),b.bufferType&&(this.Ke=b.bufferType),b.resize&&(this.ob=b.resize);switch(this.Ke){case Se:this.S=32768;this.Ca=new Uint8Array(32768+this.Je+258);break;case Re:this.S=0;this.Ca=new Uint8Array(this.Je);this.bc=this.Eh;this.Xf=this.uh;this.Re=this.yh;break;default:l(Error("invalid inflate mode"))}}
var Se=0,Re=1;
Qe.prototype.ad=function(){for(;!this.Uf;){var a=Te(this,3);a&1&&(this.Uf=q);a>>>=1;switch(a){case 0:var a=this.input,b=this.la,c=this.Ca,d=this.S,e=n,f=n,g=n,h=c.length,e=n;this.Ra=this.Yc=0;e=a[b++];e===n&&l(Error("invalid uncompressed block header: LEN (first byte)"));f=e;e=a[b++];e===n&&l(Error("invalid uncompressed block header: LEN (second byte)"));f|=e<<8;e=a[b++];e===n&&l(Error("invalid uncompressed block header: NLEN (first byte)"));g=e;e=a[b++];e===n&&l(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
e<<8;f===~g&&l(Error("invalid uncompressed block header: length verify"));b+f>a.length&&l(Error("input buffer is broken"));switch(this.Ke){case Se:for(;d+f>c.length;)e=h-d,f-=e,c.set(a.subarray(b,b+e),d),d+=e,b+=e,this.S=d,c=this.bc(),d=this.S;break;case Re:for(;d+f>c.length;)c=this.bc({cg:2});break;default:l(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),d);d+=f;this.la=b+=f;this.S=d;this.Ca=c;break;case 1:this.Re(Ue,Ve);break;case 2:We(this);break;default:l(Error("unknown BTYPE: "+a))}}return this.Xf()};
var Xe=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ye=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),Ze=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),$e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),af=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),bf=new Uint8Array(288),
cf,df;cf=0;for(df=bf.length;cf<df;++cf)bf[cf]=143>=cf?8:255>=cf?9:279>=cf?7:8;var Ue=Pe(bf),ef=new Uint8Array(30),ff,gf;ff=0;for(gf=ef.length;ff<gf;++ff)ef[ff]=5;var Ve=Pe(ef);function Te(a,b){for(var c=a.Yc,d=a.Ra,e=a.input,f=a.la,g;d<b;)g=e[f++],g===n&&l(Error("input buffer is broken")),c|=g<<d,d+=8;g=c&(1<<b)-1;a.Yc=c>>>b;a.Ra=d-b;a.la=f;return g}
function hf(a,b){for(var c=a.Yc,d=a.Ra,e=a.input,f=a.la,g=b[0],h=b[1],j;d<h;)j=e[f++],j===n&&l(Error("input buffer is broken")),c|=j<<d,d+=8;e=g[c&(1<<h)-1];g=e>>>16;a.Yc=c>>g;a.Ra=d-g;a.la=f;return e&65535}
function We(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=hf(this,b),d){case 16:for(d=3+Te(this,2);d--;)c[f++]=e;break;case 17:for(d=3+Te(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+Te(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=Te(a,5)+257,d=Te(a,5)+1,e=Te(a,4)+4,f=new Uint8Array(Xe.length),g;for(g=0;g<e;++g)f[Xe[g]]=Te(a,3);e=Pe(f);f=new Uint8Array(c);g=new Uint8Array(d);a.Re(Pe(b.call(a,c,e,f)),Pe(b.call(a,d,e,g)))}w=Qe.prototype;
w.Re=function(a,b){var c=this.Ca,d=this.S;this.$f=a;for(var e=c.length-258,f,g,h;256!==(f=hf(this,a));)if(256>f)d>=e&&(this.S=d,c=this.bc(),d=this.S),c[d++]=f;else{f-=257;h=Ye[f];0<Ze[f]&&(h+=Te(this,Ze[f]));f=hf(this,b);g=$e[f];0<af[f]&&(g+=Te(this,af[f]));d>=e&&(this.S=d,c=this.bc(),d=this.S);for(;h--;)c[d]=c[d++-g]}for(;8<=this.Ra;)this.Ra-=8,this.la--;this.S=d};
w.yh=function(a,b){var c=this.Ca,d=this.S;this.$f=a;for(var e=c.length,f,g,h;256!==(f=hf(this,a));)if(256>f)d>=e&&(c=this.bc(),e=c.length),c[d++]=f;else{f-=257;h=Ye[f];0<Ze[f]&&(h+=Te(this,Ze[f]));f=hf(this,b);g=$e[f];0<af[f]&&(g+=Te(this,af[f]));d+h>e&&(c=this.bc(),e=c.length);for(;h--;)c[d]=c[d++-g]}for(;8<=this.Ra;)this.Ra-=8,this.la--;this.S=d};
w.bc=function(){var a=new Uint8Array(this.S-32768),b=this.S-32768,c=this.Ca;a.set(c.subarray(32768,a.length));this.Ie.push(a);this.rf+=a.length;c.set(c.subarray(b,b+32768));this.S=32768;return c};w.Eh=function(a){var b=this.input.length/this.la+1|0,c=this.input,d=this.Ca;a&&("number"===typeof a.cg&&(b=a.cg),"number"===typeof a.nh&&(b+=a.nh));2>b?(a=(c.length-this.la)/this.$f[2],a=258*(a/2)|0,a=a<d.length?d.length+a:d.length<<1):a=d.length*b;a=new Uint8Array(a);a.set(d);return this.Ca=a};
w.Xf=function(){var a=0,b=this.Ca,c=this.Ie,d,e=new Uint8Array(this.rf+(this.S-32768)),f,g,h,j;if(0===c.length)return this.Ca.subarray(32768,this.S);f=0;for(g=c.length;f<g;++f){d=c[f];h=0;for(j=d.length;h<j;++h)e[a++]=d[h]}f=32768;for(g=this.S;f<g;++f)e[a++]=b[f];this.Ie=[];return this.buffer=e};w.uh=function(){var a,b=this.S;this.ob?(a=new Uint8Array(b),a.set(this.Ca.subarray(0,b))):a=this.Ca.subarray(0,b);return this.buffer=a};new Uint8Array(256);var jf;for(jf=0;256>jf;++jf)for(var kf=jf,lf=7,kf=kf>>>1;kf;kf>>>=1)--lf;var mf=[],nf;for(nf=0;288>nf;nf++)switch(q){case 143>=nf:mf.push([nf+48,8]);break;case 255>=nf:mf.push([nf-144+400,9]);break;case 279>=nf:mf.push([nf-256+0,7]);break;case 287>=nf:mf.push([nf-280+192,8]);break;default:l("invalid literal: "+nf)}
function of(){var a=pf;switch(q){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:l("invalid length: "+a)}}var qf=[],pf,rf;
for(pf=3;258>=pf;pf++)rf=of(),qf[pf]=rf[2]<<24|rf[1]<<16|rf[0];new Uint32Array(qf);function sf(){};function tf(a){this.input=a;this.la=0;this.member=[]}
tf.prototype.ad=function(){for(var a=this.input.length;this.la<a;){var b=new sf,c=n,d=n,e=n,f=c=e=n,g=n,c=c=n,h=this.input,d=this.la;b.ig=h[d++];b.jg=h[d++];(31!==b.ig||139!==b.jg)&&l(Error("invalid file signature:",b.ig,b.jg));b.Wf=h[d++];switch(b.Wf){case 8:break;default:l(Error("unknown compression method: "+b.Wf))}b.Md=h[d++];c=h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24;b.kk=new Date(1E3*c);b.ok=h[d++];b.lk=h[d++];0<(b.Md&4)&&(b.gj=h[d++]|h[d++]<<8,d+=b.gj);if(0<(b.Md&8)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.Md&16)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.Md&2)&&(b.vh=Oe.Le(h,0,d)&65535,b.vh!==(h[d++]|h[d++]<<8)&&l(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-d-4-4<512*c&&(e=c);d=new Qe(h,{index:d,bufferSize:e});b.data=e=d.ad();d=d.la;b.ck=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;Oe.Le(e)!==c&&l(Error("invalid CRC-32 checksum: 0x"+Oe.Le(e).toString(16)+
" / 0x"+c.toString(16)));b.hk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;(e.length&4294967295)!==c&&l(Error("invalid input size: "+(e.length&4294967295)+" / "+c));this.member.push(b);this.la=d}a=this.member;b=e=d=0;for(h=a.length;b<h;++b)e+=a[b].data.length;e=new Uint8Array(e);for(b=0;b<h;++b)e.set(a[b].data,d),d+=a[b].data.length;return e};function uf(){te.call(this);this.c="parserMGZ";this.sd=s}D(uf,te);
uf.prototype.parse=function(a,b,c,d){I.va(this.c+".parse");d&&(c=(new tf(new Uint8Array(c))).ad(),c=c.buffer);d=this.gd(c);b.Ia=[d.Ye,d.Ze,d.$e];b.Hb=d.Tg;c=d.min;var e=d.max;b.Na=b.X=c;b.$=b.W=e;-Infinity==b.U&&(b.U=c);Infinity==b.V&&(b.V=e);d.ma=["right","anterior","superior"];d.i=[];d.i.push(d.Va[0][0]);d.i.push(d.Va[0][1]);d.i.push(d.Va[0][2]);d.i.push(d.Va[1][0]);d.i.push(d.Va[1][1]);d.i.push(d.Va[1][2]);d.i.push(d.Va[2][0]);d.i.push(d.Va[2][1]);d.i.push(d.Va[2][2]);d.La=we(d.ma,d.i);c=xe(this,
d.La);d.orientation=c[0];d.nb=c[1];b.$b(d);I.qa(this.c+".parse");b.tb=Ae(this,b);b.A();d=new Xc;d.aa=b;d.v=a;this.dispatchEvent(d)};
uf.prototype.gd=function(a){this.z=a;a={version:0,bh:0,$g:0,Kh:0,ah:0,Ye:0,Ze:0,$e:0,ki:0,type:0,Ch:0,Ng:0,mj:r,Va:r,Tg:r,data:r,min:Infinity,max:-Infinity,ma:r,i:r,La:r,orientation:r,nb:r};a.version=Z(this,"uint");a.Ye=Z(this,"uint");a.Ze=Z(this,"uint");a.$e=Z(this,"uint");a.ki=Z(this,"uint");a.type=Z(this,"uint");a.Ch=Z(this,"uint");a.Ng=Z(this,"ushort");if(0<a.Ng){a.Tg=Z(this,"float",3);var b=[];b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",
3));a.Va=b}this.F=284;b=a.Ye*a.Ze*a.$e;switch(a.type){case 0:a.data=Z(this,"uchar",b);break;case 1:a.data=Z(this,"uint",b);break;case 3:a.data=Z(this,"float",b);break;case 4:a.data=Z(this,"ushort",b);break;default:l(Error("Unsupported MGH/MGZ data type: "+a.type))}b=ue(a.data);a.min=b[0];a.max=b[1];this.F+16<this.z.byteLength&&(a.bh=Z(this,"float"),a.Kh=Z(this,"float"),a.$g=Z(this,"float"),a.ah=Z(this,"float"));return a};C("X.parserMGZ",uf);C("X.parserMGZ.prototype.parse",uf.prototype.parse);function vf(){te.call(this);this.c="parserLBL"}D(vf,te);
vf.prototype.parse=function(a,b,c){I.va(this.c+".parse");var d=b.qc,e=d.length;0==e&&l(Error("No _pointIndices defined on the X.object."));this.z=c;var f=[],g=Z(this,"uchar",c.byteLength),h=g.length,j=s,k=0;for(c=1;c<h;c++)10==g[c-1]?(k=c,j=q):j&&32==g[c]&&(f.push(parseInt(ve(g,k,c),10)),j=s);g=b.w.u?b.w.u:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)j=d[c],j>e&&l(Error("Could not find scalar for vertex.")),j=g[j],f[h++]=j,f[h++]=j,f[h++]=j;b.w.u=
g;b.w.Fc=f;b.w.e=q;I.qa(this.c+".parse");d=new Xc;d.aa=b;d.v=a;this.dispatchEvent(d)};C("X.parserLBL",vf);C("X.parserLBL.prototype.parse",vf.prototype.parse);function wf(){te.call(this);this.c="parserCRV";this.sd=s}D(wf,te);
wf.prototype.parse=function(a,b,c){I.va(this.c+".parse");var d=b.qc;0==d.length&&l(Error("No _pointIndices defined on the X.object."));this.z=c;this.F=3;var e=Z(this,"uint");Z(this,"uint");Z(this,"uint");var f=0,g=0,h=0,j=0,k=0,m=0,p=0,u=0,x=0,v=0,z=0;c=Array(2);var F=Array(2),E=Z(this,"float",e),H;for(H=0;H<e;H++){var B=E[H];0==H&&(c[0]=F[0]=B);0<=B?(f++,j+=B):(g++,h+=B);x+=B;z++;F[0]=Math.max(B,F[0]);c[0]=Math.min(B,c[0]);E[H]=B}0!=f&&(k=j/f);0!=g&&(m=h/g);0!=z&&(v=x/z);for(z=x=h=j=0;z<e;z++)B=
E[z],H=0,0<=B?(H=Math.pow(B-k,2),j+=H):(H=Math.pow(B-m,2),h+=H),H=Math.pow(B-v,2),x+=H;1<f&&(p=Math.sqrt(j/(f-1)));1<g&&(u=Math.sqrt(h/(g-1)));c[1]=m-2.5*u;F[1]=k+2.5*p;e=d.length;f=new Float32Array(3*e);for(z=0;z<e;z++)g=E[d[z]],h=3*z,f[h]=g,f[h+1]=g,f[h+2]=g;b.w.Na=c[1];b.w.$=F[1];-Infinity==b.w.U&&(b.w.U=c[1]);Infinity==b.w.V&&(b.w.V=F[1]);b.w.u=E;b.w.Fc=f;b.w.e=q;I.qa(this.c+".parse");d=new Xc;d.aa=b;d.v=a;this.dispatchEvent(d)};C("X.parserCRV",wf);C("X.parserCRV.prototype.parse",wf.prototype.parse);function xf(){te.call(this);this.c="parserTRK"}D(xf,te);
xf.prototype.parse=function(a,b,c){I.va(this.c+".parse");var d=b.j,e=b.k,f=b.Z;this.z=c;Z(this,"uchar",6);Z(this,"ushort",3);var g=Z(this,"float",3);Z(this,"float",3);var h=Z(this,"ushort");Z(this,"uchar",200);Z(this,"ushort");Z(this,"uchar",200);c=Z(this,"float",16);Z(this,"uchar",444);Z(this,"uchar",4);Z(this,"uchar",4);Z(this,"float",6);Z(this,"uchar",2);Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");var j=Z(this,"uint");Z(this,"uint");var k=Z(this,
"uint"),m=[],p=[],u=Infinity,x=-Infinity,v=r,z=r,F=r,E=r,e=d=r,H=Z(this,"uint",(this.z.byteLength-1E3)/4);this.F=k;for(var B=Z(this,"float",(this.z.byteLength-1E3)/4),G=0,k=f=0;k<j;k++){for(var J=H[G],U=new W(3*J),N=0,K=0;K<J;K++){var O=B[G+3*K+K*h+1],R=B[G+3*K+K*h+2],S=B[G+3*K+K*h+3],O=O/g[0],R=R/g[1],S=S/g[2];U.add(O,R,S);if(0<K)var V=U.get(K-1),N=N+Math.sqrt(Math.pow(O-V[0],2)+Math.pow(R-V[1],2)+Math.pow(S-V[2],2));K<J-1&&(f+=6)}G+=3*J+J*h+1;K=U.Ub;J=U.Rb;O=U.Vb;R=U.Sb;S=U.Wb;V=U.Tb;if(!v||K<v)v=
K;if(!z||J>z)z=J;if(!F||O<F)F=O;if(!E||R>E)E=R;if(!d||S<d)d=S;if(!e||V>e)e=V;m.push(U);p.push(N)}g=(v+z)/2;F=(F+E)/2;h=(d+e)/2;E=new Float32Array(f);b.j=d=new W(f);b.k=e=new W(f);b.Z=f=new W(f);for(k=v=0;k<j;k++){z=m[k];H=z.count;N=p[k];u=Math.min(u,N);x=Math.max(x,N);for(K=0;K<H-1;K++){G=z.get(K);B=z.get(K+1);d.add(G[0],G[1],G[2]);d.add(B[0],B[1],B[2]);var U=G[0]-g,J=G[1]-F,O=G[2]-h,R=Math.sqrt(U*U+J*J+O*O),S=B[0]-g,V=B[1]-F,ja=B[2]-h,A=Math.sqrt(S*S+V*V+ja*ja);e.add(U/R,J/R,O/R);e.add(S/A,V/A,ja/
A);B=[Math.abs(B[0]-G[0]),Math.abs(B[1]-G[1]),Math.abs(B[2]-G[2])];G=Math.sqrt(B[0]*B[0]+B[1]*B[1]+B[2]*B[2]);B[0]/=G;B[1]/=G;B[2]/=G;f.add(B[0],B[1],B[2]);f.add(B[0],B[1],B[2]);E[v++]=N;E[v++]=N;E[v++]=N;E[v++]=N;E[v++]=N;E[v++]=N}}b.oa="LINES";j=new Wc;j.Na=u;j.$=x;j.U=u;j.V=x;j.Fc=E;j.Of=s;j.e=q;b.w=j;I.qa(this.c+".parse");I.d.sf(c,b.Pa.ha);c=new Xc;c.aa=b;c.v=a;this.dispatchEvent(c)};C("X.parserTRK",xf);C("X.parserTRK.prototype.parse",xf.prototype.parse);function yf(){te.call(this);this.c="parserLUT"}D(yf,te);
yf.prototype.parse=function(a,b,c){I.va(this.c+".parse");this.z=c;c=Z(this,"uchar",c.byteLength);var d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=ve(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}I.qa(this.c+".parse");c=new Xc;c.aa=b;c.v=a;this.dispatchEvent(c)};
C("X.parserLUT",yf);C("X.parserLUT.prototype.parse",yf.prototype.parse);function zf(){te.call(this);this.c="parserNRRD"}D(zf,te);
zf.prototype.parse=function(a,b,c){I.va(this.c+".parse");this.z=c;c=Z(this,"uchar",c.byteLength);var d=c.length,e=r,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=ve(c,0,g-2);f=g+1;break}var h,j,k,m,d=e.split(/\r?\n/),e=0;for(g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.ci=q;else if(!h.match(/^#/)&&(m=h.match(/(.*):(.*)/)))j=m[1].trim(),h=m[2].trim(),(k=this.Gh[j])?k.call(this,h):this[j]=h;this.ci||l(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
l(Error("Only raw or gz/gzip encoding is allowed"));if(!this.N&&(this.N=[new Q(1,0,0),new Q(0,1,0),new Q(0,0,1)],this.pf)){d=[];for(m=0;2>=m;m++)d.push(!isNaN(this.pf[m])?this.N[m].scale(this.pf[m]):n)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new tf(new Uint8Array(f))).ad();f=f.buffer;c={data:r,min:Infinity,max:-Infinity,ma:r,i:r,La:r,orientation:r,nb:r};c.data=new this.rb(f);m=ue(c.data);f=c.min=m[0];m=c.max=m[1];b.Na=b.X=f;b.$=b.W=m;b.Ia=[this.mf[0],this.mf[1],this.mf[2]];
d=(new Q(this.N[0][0],this.N[0][1],this.N[0][2])).mb();e=(new Q(this.N[1][0],this.N[1][1],this.N[1][2])).mb();g=(new Q(this.N[2][0],this.N[2][1],this.N[2][2])).mb();b.Hb=[d,e,g];-Infinity==b.U&&(b.U=f);Infinity==b.V&&(b.V=m);c.ma=c.ma=this.ma;c.i=[];c.i.push(this.N[0][0]);c.i.push(this.N[0][1]);c.i.push(this.N[0][2]);c.i.push(this.N[1][0]);c.i.push(this.N[1][1]);c.i.push(this.N[1][2]);c.i.push(this.N[2][0]);c.i.push(this.N[2][1]);c.i.push(this.N[2][2]);c.i=c.i;c.La=we(c.ma,c.i);f=xe(this,c.La);c.orientation=
c.orientation=f[0];c.nb=c.nb=f[1];b.$b(c);I.qa(this.c+".parse");b.tb=Ae(this,b);b.A();c=new Xc;c.aa=b;c.v=a;this.dispatchEvent(c)};
zf.prototype.Gh={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.rb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.rb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.rb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.rb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.rb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.rb=Uint32Array;break;case "float":this.rb=Float32Array;break;case "double":this.rb=Float64Array;break;default:l(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.fk=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.Ba=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));
return this.mf=e},space:function(a){return this.ma=a.split("-")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.N=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];c=0;for(d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.pf=e}};C("X.parserNRRD",zf);
C("X.parserNRRD.prototype.parse",zf.prototype.parse);function Af(){te.call(this);this.c="parserNII"}D(Af,te);
Af.prototype.parse=function(a,b,c){I.va(this.c+".parse");var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,q);348!=e&&(d=(new tf(new Uint8Array(d))).ad(),d=d.buffer);c=this.gd(d);e=[c.Ba[1],c.Ba[2],c.Ba[3]];b.Ia=e;b.Hb=[c.t[1],c.t[2],c.t[3]];var d=c.min,f=c.max;b.Na=b.X=d;b.$=b.W=f;-Infinity==b.U&&(b.U=d);Infinity==b.V&&(b.V=f);c.ma=["right","anterior","superior"];c.i=[];c.i.push(c.kd[0]);c.i.push(c.ld[0]);c.i.push(c.md[0]);c.i.push(c.kd[1]);c.i.push(c.ld[1]);
c.i.push(c.md[1]);c.i.push(c.kd[2]);c.i.push(c.ld[2]);c.i.push(c.md[2]);c.La=we(c.ma,c.i);d=xe(this,c.La);c.orientation=d[0];c.nb=d[1];d=Ic();f=[];if(0==c.hf)Mc(d,0,c.t[1],0,0,0),Mc(d,0,0,c.t[2],0,0),Mc(d,0,0,0,c.t[3],0),f.push(c.t[1]),f.push(0),f.push(0),f.push(0),f.push(c.t[2]),f.push(0),f.push(0),f.push(0),f.push(c.t[3]);else if(0<c.hf){var g=0,h=c.Kg,j=c.Lg,k=c.Mg,m=1,p=1,u=1,x=c.Hg,v=c.Ig,z=c.Jg,g=1-(h*h+j*j+k*k);1E-7>g?(g=1/Math.sqrt(h*h+j*j+k*k),h*=g,j*=g,k*=g,g=0):g=Math.sqrt(g);0<c.t[1]&&
(m=c.t[1]);0<c.t[2]&&(p=c.t[2]);0<c.t[2]&&(u=c.t[3]);0>c.t[0]&&(u=-u);Mc(d,0,(g*g+h*h-j*j-k*k)*m,2*(h*j-g*k)*p,2*(h*k+g*j)*u,x);Mc(d,1,2*(h*j+g*k)*m,(g*g+j*j-h*h-k*k)*p,2*(j*k-g*h)*u,v);Mc(d,2,2*(h*k-g*j)*m,2*(j*k+g*h)*p,(g*g+k*k-j*j-h*h)*u,z);f.push((g*g+h*h-j*j-k*k)*m);f.push(2*(h*j+g*k)*m);f.push(2*(h*k+g*j)*u);f.push(2*(h*j-g*k)*p);f.push((g*g+j*j-h*h-k*k)*p);f.push(2*(j*k-g*h)*u);f.push(2*(h*k+g*j)*u);f.push(2*(j*k+g*h)*p);f.push((g*g+k*k-j*j-h*h)*u)}else 0<c.Og&&(f=c.kd,g=c.ld,h=c.md,Mc(d,0,
f[0],f[1],f[2],f[3]),Mc(d,0,g[0],g[1],g[2],g[3]),Mc(d,0,h[0],h[1],h[2],h[3]));f=e[0]/2;g=e[1]/2;h=e[2]/2;e=new Float32Array(4);e[0]=f;e[1]=g;e[2]=h;e[3]=1;f=new Float32Array(4);g=e[0];h=e[1];j=e[2];e=e[3];f[0]=g*d[0]+h*d[4]+j*d[8]+e*d[12];f[1]=g*d[1]+h*d[5]+j*d[9]+e*d[13];f[2]=g*d[2]+h*d[6]+j*d[10]+e*d[14];f[3]=g*d[3]+h*d[7]+j*d[11]+e*d[15];b.o=[f[0],f[1],f[2]];b.$b(c);I.qa(this.c+".parse");b.tb=Ae(this,b);b.A();c=new Xc;c.aa=b;c.v=a;this.dispatchEvent(c)};
Af.prototype.gd=function(a){this.z=a;a={Xi:0,wh:r,xh:r,Fh:0,Vi:0,Qi:0,Bh:r,Ba:r,Zh:0,$h:0,ai:0,Xh:0,Qe:0,qh:0,aj:0,t:r,Ug:0,Ui:0,Ti:0,$i:0,Yi:r,hj:r,sh:0,th:0,Zi:0,ej:0,Mh:0,Nh:0,zh:r,ph:r,hf:0,Og:0,Kg:0,Lg:0,Mg:0,Hg:0,Ig:0,Jg:0,kd:r,ld:r,md:r,Yh:r,ei:r,data:r,min:Infinity,max:-Infinity,ma:r,i:r,La:r,orientation:r,nb:r};a.Xi=Z(this,"uint");a.wh=Z(this,"uchar",10);a.xh=Z(this,"uchar",18);a.Fh=Z(this,"uint");a.Vi=Z(this,"ushort");a.Qi=Z(this,"uchar");a.Bh=Z(this,"uchar");a.Ba=Z(this,"ushort",8);a.Zh=
Z(this,"float");a.$h=Z(this,"float");a.ai=Z(this,"float");a.Xh=Z(this,"ushort");a.Qe=Z(this,"ushort");a.qh=Z(this,"ushort");a.aj=Z(this,"ushort");a.t=Z(this,"float",8);a.Ug=Z(this,"float");a.Ui=Z(this,"float");a.Ti=Z(this,"float");a.$i=Z(this,"ushort");a.Yi=Z(this,"uchar");a.hj=Z(this,"uchar");a.sh=Z(this,"float");a.th=Z(this,"float");a.Zi=Z(this,"float");a.ej=Z(this,"float");a.Mh=Z(this,"uint",1);a.Nh=Z(this,"uint",1);a.zh=Z(this,"uchar",80);a.ph=Z(this,"uchar",24);a.hf=Z(this,"ushort");a.Og=Z(this,
"ushort");a.Kg=Z(this,"float");a.Lg=Z(this,"float");a.Mg=Z(this,"float");a.Hg=Z(this,"float");a.Ig=Z(this,"float");a.Jg=Z(this,"float");a.kd=Z(this,"float",4);a.ld=Z(this,"float",4);a.md=Z(this,"float",4);a.Yh=Z(this,"uchar",16);a.ei=Z(this,"uchar",4);this.F=parseInt(a.Ug,10);var b=a.Ba[1]*a.Ba[2]*a.Ba[3];switch(a.Qe){case 2:a.data=Z(this,"uchar",b);break;case 4:a.data=Z(this,"sshort",b);break;case 8:a.data=Z(this,"sint",b);break;case 16:a.data=Z(this,"float",b);break;case 32:a.data=Z(this,"complex",
b);break;case 64:a.data=Z(this,"double",b);break;case 256:a.data=Z(this,"schar",b);break;case 512:a.data=Z(this,"ushort",b);break;case 768:a.data=Z(this,"uint",b);break;default:l(Error("Unsupported NII data type: "+a.Qe))}b=ue(a.data);a.min=b[0];a.max=b[1];return a};C("X.parserNII",Af);C("X.parserNII.prototype.parse",Af.prototype.parse);function Bf(){te.call(this);this.c="parserOBJ"}D(Bf,te);
Bf.prototype.parse=function(a,b,c){I.va(this.c+".parse");this.z=c;c=c.byteLength;var d=Z(this,"uchar",c),e=[];b.j=new W(c);b.k=new W(c);var f=b.j,g=b.k,h=0,j;for(j=0;j<c;++j)if(10==d[j]){var k=ve(d,h,j).replace(/\s{2,}/g," ").split(" ");if("v"==k[0])e.push([parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])]);else if("f"==k[0]){var m=e[parseInt(k[1],10)-1],h=e[parseInt(k[2],10)-1],k=e[parseInt(k[3],10)-1];f.add(m[0],m[1],m[2]);f.add(h[0],h[1],h[2]);f.add(k[0],k[1],k[2]);m=new Q(m[0],m[1],m[2]);k=
new Q(k[0],k[1],k[2]);h=Ec((new Q(h[0],h[1],h[2])).pa(m),k.pa(m));h.normalize();g.add(h.x,h.y,h.b);g.add(h.x,h.y,h.b);g.add(h.x,h.y,h.b)}h=j+1}I.qa(this.c+".parse");c=new Xc;c.aa=b;c.v=a;this.dispatchEvent(c)};C("X.parserOBJ",Bf);C("X.parserOBJ.prototype.parse",Bf.prototype.parse);function Cf(){M.call(this);this.c="loader";this.nc=new wc;this.Tc=0}D(Cf,M);function Df(a,b){a.Tc+=b/a.nc.Nd()/3;a.Tc=Math.min(1,a.Tc);var c=new ud;c.Sf=a.Tc;a.dispatchEvent(c)}function Ef(a){a=a.m.xd;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Ff||l(Error("The "+b+" file format is not supported."));return[a,b,Ff[b][0],Ff[b][1],Ff[b][2]]}
Cf.prototype.load=function(a,b){(!a||!b)&&l(Error("No container or object to load."));if(!zc(this.nc.A,a.ga)||this.nc.get(a.ga)){this.nc.set(a.ga,s);var c=Ef(a)[0];if(a.Wa!=r)this.parse(r,a,b);else{var d=new XMLHttpRequest;Vb(d,"abort",this.bg.bind(this,d,a,b));Vb(d,"error",this.bg.bind(this,d,a,b));Vb(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,q);d.responseType="arraybuffer";d.send(r)}}};
Cf.prototype.parse=function(a,b,c){Df(this,1);setTimeout(function(){var d=Ef(b),e=d[3],d=new d[2];Yb(d,id,this.complete.bind(this));var f=b.Wa;f==r&&(f=a.response,b.Wa=f);d.parse(b,c,f,e)}.bind(this),100)};Cf.prototype.complete=function(a){Df(this,1);setTimeout(function(){var b=a.v,c=a.aa;b.m.e=s;b.e=q;c.l();this.nc.set(b.ga,q)}.bind(this),100)};Cf.prototype.bg=function(a,b,c){l(Error("Loading failed: ",b,c))};
var Ff={OBJ:[Bf,r],STL:[Je,r],VTK:[Le,r],TRK:[xf,r],FSM:[Ne,r],INFLATED:[Ne,r],SMOOTHWM:[Ne,r],SPHERE:[Ne,r],PIAL:[Ne,r],ORIG:[Ne,r],NRRD:[zf,r],NII:[Af,r],GZ:[Af,r],DCM:[Ke,r],DICOM:[Ke,r],"":[Ke,r],CRV:[wf,r],LABEL:[vf,r],MGH:[uf,s],MGZ:[uf,q],TXT:[yf,r],LUT:[yf,r],PNG:[Ce,"png"],JPG:[Ce,"jpeg"],JPEG:[Ce,"jpeg"],GIF:[Ce,"gif"]};function Gf(a){function b(a,b,d){b=2*b*Math.PI;b=za(Aa(j,Math.cos(b)),Aa(k,Math.sin(b)));a=za(za(c,Aa(e,a)),Aa(b,f));d=za(Aa(b,1-Math.abs(d)),Aa(g,d));return new gc(a,d)}this.I=[];a=a||{};var c=new ya(a.start||[0,-1,0]),d=new ya(a.end||[0,1,0]),e=Ba(d,c),f=a.ab||1;a=a.nf||16;for(var g=Ca(e),h=0.5<Math.abs(g.y()),j=Ca((new ya(h,!h,0)).ac(g)),k=Ca(j.ac(g)),h=new gc(c,Ea(g)),d=new gc(d,Ca(g)),m=[],p=0;p<a;p++){var u=p/a,x=(p+1)/a;m.push(new ic([h,b(0,u,-1),b(0,x,-1)]));m.push(new ic([b(0,x,0),b(0,u,
0),b(1,u,0),b(1,x,0)]));m.push(new ic([d,b(1,x,1),b(1,u,1)]))}return rc(m)}D(Gf,qc);function Hf(){Y.call(this);this.c="cylinder";this.De=[-10,-10,-10];this.je=[10,10,10];this.Yb=10;this.Uc=32;Fa(this,new Zc)}D(Hf,Y);Hf.prototype.__defineGetter__("start",t("De"));Hf.prototype.__defineSetter__("start",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid start"));this.De=a});Hf.prototype.__defineGetter__("end",t("je"));Hf.prototype.__defineSetter__("end",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid end"));this.je=a});Hf.prototype.__defineGetter__("radius",t("Yb"));
Hf.prototype.__defineSetter__("radius",function(a){y(a)||l(Error("Invalid radius."));this.Yb=a});Hf.prototype.l=function(){ad(this,new Gf({start:this.De,end:this.je,ab:this.Yb,nf:this.Uc}));Hf.q.l.call(this)};C("X.cylinder",Hf);C("X.cylinder.prototype.modified",Hf.prototype.l);function If(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var e=new ya(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new gc(za(c,Aa(e,d)),e))}this.I=[];a=a||{};var c=new ya(a.Me||[0,0,0]),d=a.ab||1,e=a.nf||16;a=a.bj||8;for(var f=[],g=[],h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new ic(g));return rc(f)}D(If,qc);function Jf(){Y.call(this);this.c="sphere";this.o=[0,0,0];this.Yb=5;this.Uc=32;this.jh=16;Fa(this,new Zc)}D(Jf,Y);Jf.prototype.__defineGetter__("center",t("o"));Jf.prototype.__defineSetter__("center",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid center"));this.o=a});Jf.prototype.__defineGetter__("radius",t("Yb"));Jf.prototype.__defineSetter__("radius",function(a){y(a)||l(Error("Invalid radius."));this.Yb=a});
Jf.prototype.l=function(){ad(this,new If({Me:this.o,ab:this.Yb,nf:this.Uc,bj:this.jh}));Jf.q.l.call(this)};C("X.sphere",Jf);C("X.sphere.prototype.modified",Jf.prototype.l);function Ie(a){P.call(this);this.c="labelmap";this.jb=a;this.Be=new Float32Array([-255,-255,-255,-255])}D(Ie,P);Ie.prototype.l=function(){var a=new Xc;a.aa=this;this.dispatchEvent(a);this.jb.l()};Ie.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];a!=r&&(ka(a)&&4==a.length?b=a:(this.gb||l(Error("No colortable assigned.")),b=this.gb.zb.get(a).slice(1,5)));this.Be=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])});
C("X.labelmap",Ie);function Kf(a){this.I=[];a=a||{};var b=new ya(a.Me||[0,0,0]),c=!a.ab?[1,1,1]:a.ab.length?a.ab:[a.ab,a.ab,a.ab];return rc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new ic(a[0].map(function(e){e=new ya(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new gc(e,new ya(a[1]))}))}))}D(Kf,qc);function Lf(){Y.call(this);this.c="cube";this.o=[0,0,0];this.qe=this.pe=this.oe=20;this.xc=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Fa(this,new Zc)}D(Lf,Y);Lf.prototype.__defineGetter__("center",t("o"));Lf.prototype.__defineSetter__("center",function(a){(a==r||!ka(a)||3!=a.length)&&l(Error("Invalid center"));this.o=a});Lf.prototype.__defineGetter__("lengthX",t("oe"));
Lf.prototype.__defineSetter__("lengthX",function(a){y(a)||l(Error("Invalid lengthX."));this.oe=a});Lf.prototype.__defineGetter__("lengthY",t("pe"));Lf.prototype.__defineSetter__("lengthY",function(a){y(a)||l(Error("Invalid lengthY."));this.pe=a});Lf.prototype.__defineGetter__("lengthZ",t("qe"));Lf.prototype.__defineSetter__("lengthZ",function(a){y(a)||l(Error("Invalid lengthZ."));this.qe=a});Lf.prototype.l=function(){ad(this,new Kf({Me:this.o,ab:[this.oe/2,this.pe/2,this.qe/2]}));Lf.q.l.call(this)};
C("X.cube",Lf);C("X.cube.prototype.modified",Lf.prototype.l);function oe(a){me.call(this,a);this.c="interactor3D";this.Xj=s}D(oe,me);oe.prototype.ed=function(a){oe.q.ed.call(this,a);var b=new pd;a.Bc==r&&(a.Bc=0);b.Xa=0>a.Bc;b.Ma=q;this.dispatchEvent(b)};function Mf(a){M.call(this);this.c="array";this.u=[];this.yf=a}D(Mf,M);function Nf(a,b,c){for(var d=0;4>d;d++)if(a[d+0]!==b[d+c])return s;return q}Mf.prototype.add=function(a){this.u.push(a);return q};Mf.prototype.remove=function(a){a=this.u.indexOf(a);-1<a&&this.u.splice(a,1);return q};Mf.prototype.clear=function(){this.u.length=0};
function Of(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Of(a,b,d);for(Of(a,d,c);b<d;++b)if(0<a.yf(a.u[b],a.u[d])){var e=a.u[b];a.u[b]=a.u[d];for(var f=a,g=d,h=c;g+1<h&&0>f.yf(f.u[g+1],e);){var j=f,k=g+1,m=j.u[g];j.u[g]=j.u[k];j.u[k]=m;++g}f.u[g]=e}}}Mf.prototype.sort=function(){Of(this,0,this.u.length)};function Pf(a){Lb.call(this);this.lb=a;this.D=[]}D(Pf,Lb);var Qf=[];function Rf(a,b,c,d,e){ka(c)||(Qf[0]=c,c=Qf);for(var f=0;f<c.length;f++){var g=Vb(b,c[f],d||a,e||s,a.lb||a);a.D.push(g)}}Pf.prototype.jf=function(){Gb(this.D,$b);this.D.length=0};Pf.prototype.handleEvent=function(){l(Error("EventHandler.handleEvent not implemented"))};function Sf(){}Sf.dg=function(){return Sf.lg?Sf.lg:Sf.lg=new Sf};Sf.prototype.ji=0;Sf.dg();function Tf(a){fc.call(this);this.Kb=a||Fd();this.Si=Uf}D(Tf,fc);Tf.prototype.Vh=Sf.dg();var Uf=r;w=Tf.prototype;w.kg=r;w.Dc=s;w.s=r;w.Si=r;w.fd=r;w.Zc=r;w.Ne=r;w.n=t("s");w.lf=function(a){this.fd&&this.fd!=a&&l(Error("Method not supported"));Tf.q.lf.call(this,a)};w.Od=t("Kb");w.Ac=function(){this.s=this.Kb.createElement("div")};w.fc=function(a){this.Nb(a)};
w.Nb=function(a,b){this.Dc&&l(Error("Component already rendered"));this.s||this.Ac();a?a.insertBefore(this.s,b||r):this.Kb.R.body.appendChild(this.s);(!this.fd||this.fd.Dc)&&this.Kd()};w.Kd=function(){function a(a){!a.Dc&&a.n()&&a.Kd()}this.Dc=q;this.Zc&&Gb(this.Zc,a,n)};w.Ld=function(){function a(a){a.Dc&&a.Ld()}this.Zc&&Gb(this.Zc,a,n);this.Oh&&this.Oh.jf();this.Dc=s};
w.removeChild=function(a,b){if(a){var c=ma(a)?a:a.kg||(a.kg=":"+(a.Vh.ji++).toString(36)),d;this.Ne&&c?(d=this.Ne,d=(c in d?d[c]:n)||r):d=r;a=d;c&&a&&(d=this.Ne,c in d&&delete d[c],Jb(this.Zc,a),b&&(a.Ld(),a.s&&Md(a.s)),c=a,c==r&&l(Error("Unable to set parent component")),c.fd=r,Tf.q.lf.call(c,r))}a||l(Error("Child is not in parent component"));return a};function Wf(){fc.call(this)}D(Wf,fc);w=Wf.prototype;w.uf=0;w.dd=0;w.Xe=100;w.ag=0;w.qf=1;w.bi=s;w.ii=s;w.ee=function(a){a=Xf(this,a);this.uf!=a&&(this.uf=a+this.ag>this.Xe?this.Xe-this.ag:a<this.dd?this.dd:a,!this.bi&&!this.ii&&this.dispatchEvent("change"))};w.Rd=function(){return Xf(this,this.uf)};w.Qd=function(){return Xf(this,this.dd)};w.Pd=function(){return Xf(this,this.Xe)};function Xf(a,b){return a.qf==r?b:a.dd+Math.round((b-a.dd)/a.qf)*a.qf};function Yf(a){Tf.call(this,a);this.hd=new Wf;Vb(this.hd,"change",this.Ph,s,this)}D(Yf,Tf);var Zf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=Yf.prototype;w.Ac=function(){this.bb=this.Od().Ac("div","progress-bar-thumb");var a=Zf[this.Cg];this.s=this.Od().Ac("div",a,this.bb);$f(this);a=this.Qd();this.n().setAttribute("aria-valuemin",a);a=this.Pd();this.n().setAttribute("aria-valuemax",a)};
w.Kd=function(){Yf.q.Kd.call(this);L&&7>rb&&Vb(this.n(),"resize",this.he,s,this);this.he();var a=this.n();a.setAttribute("role","progressbar");a.setAttribute("aria-live","polite")};w.Ld=function(){Yf.q.Ld.call(this);L&&7>rb&&Zb(this.n(),"resize",this.he,s,this)};w.Rd=function(){return this.hd.Rd()};w.ee=function(a){this.hd.ee(a);this.n()&&$f(this)};function $f(a){var b=a.Rd();a.n().setAttribute("aria-valuenow",b)}w.Qd=function(){return this.hd.Qd()};w.Pd=function(){return this.hd.Pd()};w.Cg="horizontal";
w.Ph=function(){this.he();this.dispatchEvent("change")};w.he=function(){if(this.bb){var a=this.Qd(),b=this.Pd(),a=(this.Rd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Cg?L&&7>rb?(this.bb.style.top=0,this.bb.style.height="100%",b=this.bb.offsetHeight,a=Math.round(a*b),this.bb.style.top=b-a+"px",this.bb.style.height=a+"px"):(this.bb.style.top=100-b+"%",this.bb.style.height=b+"%"):this.bb.style.width=b+"%"}};function ag(a,b){a==r&&l(Error("No valid parent element."));b==r&&l(Error("Invalid initial value."));Yf.call(this);this.c="progressbar";this.Ja=a;this.Kf="";this.pd=this.ib=r;this.Pb=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
d+="  overflow: hidden;\n";d+="  width: 0%;\n";d+="  height: 100%;\n";d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.Pb=[c,d,e];this.ee(b);this.Te()}D(ag,Yf);
ag.prototype.Te=function(){var a=Sd(this.Ja,"position");if("static"==a||""==a)this.Kf=this.Ja.style.position,this.Ja.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Kd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.Pb[0])),d=document.createTextNode(String(this.Pb[1])),e=document.createTextNode(String(this.Pb[2]));a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.ib=b;this.fc(this.Ja);a=this.n();a.style.position=
"absolute";a.style.top=(this.Ja.clientHeight-5)/2+"px";a.style.left=(this.Ja.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function bg(a){var b=a.n().style.top,c=a.n().style.left;Md(a.n());var d=new ag(a.Ja,100),e=d.n();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=n?e.firstElementChild:Nd(e.firstChild)).classList.add("progress-bar-thumb-done");a.pd=d}
ag.prototype.Td=function(){this.ib&&Md(this.ib);this.n()&&Md(this.n());this.pd&&Md(this.pd.n());this.pd=this.ib=r;this.Ja.style.position=this.Kf};function cg(a,b,c){na(a)?c&&(a=ua(a,c)):a&&"function"==typeof a.handleEvent?a=ua(a.handleEvent,a):l(Error("Invalid listener argument"));return 2147483647<b?-1:da.setTimeout(a,b||0)};function dg(){M.call(this);this.c="renderer";this.v=window.document.body;this.H=this.v.clientWidth;this.C=this.v.clientHeight;this.na=this.r=this.fa=r;this.Za=new Mf(Yc);this.Ka=[];this.K=r;this.ue=this.td=this.ud=s;this.a=this.ra=r;this.J={PROGRESSBAR_ENABLED:q,INTERMEDIATE_RENDERING:s,SLICENAVIGATORS:q};this.wf=-1;window.console.log("XTK release 10 -- 2013-06-21 09:05:49 -- http://www.goXTK.com -- @goXTK")}D(dg,M);w=dg.prototype;w.yi=function(a){this.ra&&this.ra.ee(100*a.Sf)};
w.oi=function(a){a!=r&&a instanceof Xc&&a.aa&&this.cb(a.aa)};w.cf=function(a){(a==r||!(a instanceof rd))&&l(Error("Invalid hover event."))};w.df=function(){var a=Id(this.v);this.H=a.clientWidth;this.C=a.clientHeight;a=Id(this.fa);a.width=this.H;a.height=this.C;"renderer3D"==this.c&&(this.a.viewport(0,0,this.H,this.C),this.r.Lf=I.d.We(I.d.cd(),this.r.Af,this.fa.width/this.fa.height,1,1E4))};w.ef=function(a){(a==r||!(a instanceof qd))&&l(Error("Invalid scroll event."))};
dg.prototype.__defineGetter__("config",t("J"));dg.prototype.__defineGetter__("interactor",t("na"));dg.prototype.__defineGetter__("camera",t("r"));dg.prototype.__defineGetter__("loadingCompleted",t("td"));dg.prototype.__defineGetter__("container",t("v"));dg.prototype.__defineSetter__("container",function(a){a==r&&l(Error("An ID to a valid container (<div>..) is required."));var b=a;ma(b)&&(b=Id(a));oa(b)&&1==b.nodeType||l(Error("Could not find the given container."));this.v=b});w=dg.prototype;
w.jd=function(){this.r.reset()};
w.ka=function(a){var b=Kd("canvas");this.v.appendChild(b);this.H=this.v.clientWidth;this.C=this.v.clientHeight;b.width=this.H;b.height=this.C;try{var c=b.getContext(a);c||l(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.v.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
l(Error(e))}this.K=new Cf;Vb(this.K,jd,this.yi.bind(this));this.fa=b;this.a=c;b=new oe(this.fa);"2d"==a&&(b=new qe(this.fa));b.ka();Vb(b,gd,this.jd.bind(this));Vb(b,kd,this.cf.bind(this));Vb(b,fd,this.ef.bind(this));this.na=b;b=new se(this.H,this.C);"2d"==a&&(b=new De(this.H,this.C));b.observe(this.na);this.r=b;Vb(window,"resize",this.df,s,this)};w.add=function(a){(a instanceof Lf||a instanceof Jf||a instanceof Hf)&&a.l();this.Ka.push(a);this.cb(a)};
w.remove=function(a){(!this.fa||!this.a)&&l(Error("The renderer was not initialized properly."));a==r&&l(Error("Illegal object."));return s};w.cb=function(a){(!this.fa||!this.a)&&l(Error("The renderer was not initialized properly."));a==r&&(window.console.log(a),l(Error("Illegal object.")));var b;b=pa(a);var c=Tb[b];if(c){var d=ga(id),e=ga(n);d&&e?(c=Rb[id],b=!!c&&!!c[n]&&b in c[n]):b=!d&&!e?q:Ib(c,function(a){return d&&a.type==id||e&&a.capture==n})}else b=s;b||Vb(a,id,this.oi.bind(this))};
w.get=function(a){a==r&&l(Error("Invalid object id."));for(var b=this.Za.u,c=b.length,d=0,d=0;d<c;d++)if(b[d].ga==a)return b[d];return r};
w.fc=function(){(!this.fa||!this.a)&&l(Error("The renderer was not initialized properly."));if(this.Nf==r){if(yc(this.K.nc)){if(this.J.PROGRESSBAR_ENABLED&&!this.ra&&(this.ra=new ag(this.v,3)),this.ue=this.td=s,this.Nf=cg(function(){this.Nf=r;this.fc()}.bind(this),100),!this.J.INTERMEDIATE_RENDERING)return}else if(!this.td&&!this.ue&&(this.ue=q,eval("this.onShowtime()"),this.td=q),this.ra){this.J.PROGRESSBAR_ENABLED&&(this.ra&&!this.xf)&&(bg(this.ra),this.xf=cg(function(){this.xf=r;this.ra&&(this.ra.Td(),
this.ra=r);this.fc()}.bind(this),700));return}this.wf=window.requestAnimationFrame(this.fc.bind(this),this.fa);eval("this.onRender()");this.Nb(s,q)}};w.Bg=aa();w.zg=aa();w.Nb=aa();
w.Id=function(){window.cancelAnimationFrame(this.wf);this.K&&(delete this.K,this.K=r);this.ra&&(this.ra.Td(),delete this.ra,this.ra=r);this.Za.clear();delete this.Za;this.Ka.length=0;delete this.Ka;delete this.K;this.K=r;delete this.r;this.r=r;delete this.na;this.na=r;delete this.a;this.a=r;Md(this.fa);delete this.fa;this.fa=r};function eg(a,b,c,d,e,f,g,h){var j,k;if(j=c.offsetParent){var m="HTML"==j.tagName||"BODY"==j.tagName;if(!m||"static"!=Td(j,"position"))k=Yd(j),m||(m=(m=Zd(j))&&lb?-j.scrollLeft:m&&(!L||!yb("8"))&&"visible"!=Td(j,"overflowX")?j.scrollWidth-j.clientWidth-j.scrollLeft:j.scrollLeft,k=xd(k,new wd(m,j.scrollTop)))}j=k||new wd;k=Yd(a);m=ce(a);k=new Ad(k.x,k.y,m.width,m.height);(m=Xd(a))&&k.mg(new Ad(m.left,m.top,m.right-m.left,m.bottom-m.top));var m=Fd(a),p=Fd(c);if(m.R!=p.R){var u=m.R.body,p=p.R.parentWindow||
p.R.defaultView,x=new wd(0,0),v=Hd(u)?Hd(u).parentWindow||Hd(u).defaultView:window,z=u;do{var F=v==p?Yd(z):$d(z);x.x+=F.x;x.y+=F.y}while(v&&v!=p&&(z=v.frameElement)&&(v=v.parent));u=xd(x,Yd(u));L&&!Qd(m)&&(u=xd(u,Rd(m)));k.left+=u.x;k.top+=u.y}a=(b&4&&Zd(a)?b^2:b)&-5;b=new wd(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);b=xd(b,j);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var E;if(g&&(E=Xd(c)))E.top-=j.y,E.right-=j.x,E.bottom-=j.y,E.left-=j.x;return fg(b,c,d,f,E,g,h)}
function fg(a,b,c,d,e,f,g){a=a.g();var h=0,j=(c&4&&Zd(b)?c^2:c)&-5;c=ce(b);g=g?g.g():c.g();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&(h.x+g.width>e.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y<=e.top&&(h.y+g.height<e.bottom&&f&32)&&(g.height=Math.max(g.height-(e.top-h.y),0),h.y=0,d|=8);h.y>=e.top&&(h.y+g.height>e.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=lb&&(ab||pb)&&yb("1.9");f instanceof
wd?(a=f.x,f=f.y):(a=f,f=n);b.style.left=be(a,e);b.style.top=be(f,e);if(!(c==g||(!c||!g?0:c.width==g.width&&c.height==g.height)))a=Qd(Fd(Hd(b))),L&&(!a||!yb("8"))?(c=b.style,a?(L?(a=ge(b,"paddingLeft"),e=ge(b,"paddingRight"),f=ge(b,"paddingTop"),d=ge(b,"paddingBottom"),a=new yd(f,e,d,a)):(a=Sd(b,"paddingLeft"),e=Sd(b,"paddingRight"),f=Sd(b,"paddingTop"),d=Sd(b,"paddingBottom"),a=new yd(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),L?(e=ie(b,"borderLeft"),f=ie(b,"borderRight"),d=ie(b,"borderTop"),
b=ie(b,"borderBottom"),b=new yd(d,f,b,e)):(e=Sd(b,"borderLeftWidth"),f=Sd(b,"borderRightWidth"),d=Sd(b,"borderTopWidth"),b=Sd(b,"borderBottomWidth"),b=new yd(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,lb?b.MozBoxSizing="border-box":mb?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",
b.height=Math.max(g.height,0)+"px");return h};function gg(){}gg.prototype.Ua=aa();function hg(a,b){this.Oe=a instanceof wd?a:new wd(a,b)}D(hg,gg);hg.prototype.Ua=function(a,b,c,d){eg(Ud(a),0,a,b,this.Oe,c,r,d)};function ig(a,b,c){this.element=a;this.Zf=b;this.Mi=c}D(ig,gg);ig.prototype.Ua=function(a,b,c){eg(this.element,this.Zf,a,b,n,c,this.Mi)};function jg(a,b){fc.call(this);this.lb=new Pf(this);this.kf(a||r);b&&(this.Ec=b)}D(jg,fc);w=jg.prototype;w.s=r;w.oh=q;w.Tf=r;w.ta=s;w.Wi=s;w.Ve=-1;w.pg=-1;w.Uh=s;w.Dh=q;w.Ec="toggle_display";w.n=t("s");w.kf=function(a){this.ta&&l(Error("Can not change this state of the popup while showing."));this.s=a};
function kg(a,b){a.ge&&a.ge.stop();a.Sd&&a.Sd.stop();if(b){if(!a.ta&&a.af()){a.s||l(Error("Caller must call setElement before trying to show the popup"));a.Ua();var c=Hd(a.s);a.Uh&&Rf(a.lb,c,"keydown",a.mi,q);if(a.oh)if(Rf(a.lb,c,"mousedown",a.xg,q),L){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}Rf(a.lb,c,"mousedown",a.xg,q);Rf(a.lb,c,"deactivate",a.wg)}else Rf(a.lb,c,"blur",a.wg);"toggle_display"==
a.Ec?(a.s.style.visibility="visible",ee(a.s,q)):"move_offscreen"==a.Ec&&a.Ua();a.ta=q;a.ge?(Yb(a.ge,"end",a.Ag,s,a),a.ge.play()):a.Ag()}}else lg(a)}w.Ua=ea;function lg(a,b){if(!a.ta||!a.dispatchEvent({type:"beforehide",target:b}))return s;a.lb&&a.lb.jf();a.ta=s;a.pg=xa();a.Sd?(Yb(a.Sd,"end",va(a.Yf,b),s,a),a.Sd.play()):a.Yf(b);return q}w.Yf=function(a){"toggle_display"==this.Ec?this.Wi?cg(this.hg,0,this):this.hg():"move_offscreen"==this.Ec&&(this.s.style.top="-10000px");this.bf(a)};
w.hg=function(){this.s.style.visibility="hidden";ee(this.s,s)};w.af=function(){return this.dispatchEvent("beforeshow")};w.Ag=function(){this.Ve=xa();this.pg=-1;this.dispatchEvent("show")};w.bf=function(a){this.dispatchEvent({type:"hide",target:a})};w.xg=function(a){a=a.target;!Pd(this.s,a)&&((!this.Tf||Pd(this.Tf,a))&&!(150>xa()-this.Ve))&&lg(this,a)};w.mi=function(a){27==a.keyCode&&lg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
w.wg=function(a){if(this.Dh){var b=Hd(this.s);if(L||kb){if(a=b.activeElement,!a||Pd(this.s,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>xa()-this.Ve||lg(this)}};function mg(a,b){this.Pi=4;this.Yd=b||n;jg.call(this,a)}D(mg,jg);mg.prototype.Ua=function(){if(this.Yd){var a=!this.ta&&"move_offscreen"!=this.Ec,b=this.n();a&&(b.style.visibility="hidden",ee(b,q));this.Yd.Ua(b,this.Pi,this.jk);a&&ee(b,s)}};function ng(a){this.A=new wc;a&&this.Ge(a)}function og(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+pa(a):b.substr(0,1)+a}w=ng.prototype;w.Nd=function(){return this.A.Nd()};w.add=function(a){this.A.set(og(a),a)};w.Ge=function(a){a=vc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};w.jf=function(a){a=vc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};w.remove=function(a){return this.A.remove(og(a))};w.clear=function(){this.A.clear()};
w.contains=function(a){a=og(a);return zc(this.A.A,a)};w.mg=function(a){var b=new ng;a=vc(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};w.bd=function(){return this.A.bd()};w.g=function(){return new ng(this)};function pg(a,b,c){this.Kb=c||(a?Fd(Id(a)):Fd());mg.call(this,this.Kb.Ac("div",{style:"position:absolute;display:none;"}));this.Pe=new wd(1,1);this.Jd=new ng;a&&qg(this,a);if(b!=r)if(a=this.n(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Hd(a).createTextNode(String(b)))}}D(pg,mg);var rg=[];w=pg.prototype;w.Aa=r;w.className="goog-tooltip";
w.Pg=500;w.Th=0;w.Od=t("Kb");function qg(a,b){b=Id(b);a.Jd.add(b);Vb(b,"mouseover",a.Sh,s,a);Vb(b,"mouseout",a.eg,s,a);Vb(b,"mousemove",a.Rh,s,a);Vb(b,"focus",a.Qh,s,a);Vb(b,"blur",a.eg,s,a)}w.kf=function(a){var b=this.n();b&&Md(b);pg.q.kf.call(this,a);a&&(b=this.Kb.R.body,b.insertBefore(a,b.lastChild))};
w.af=function(){if(!jg.prototype.af.call(this))return s;if(this.anchor)for(var a,b=0;a=rg[b];b++)Pd(a.n(),this.anchor)||kg(a,s);0<=Fb(rg,this)||rg.push(this);a=this.n();a.className=this.className;sg(this);Vb(a,"mouseover",this.gg,s,this);Vb(a,"mouseout",this.fg,s,this);tg(this);return q};
w.bf=function(){Jb(rg,this);for(var a=this.n(),b,c=0;b=rg[c];c++)b.anchor&&Pd(a,b.anchor)&&kg(b,s);this.Eg&&ug(this.Eg);Zb(a,"mouseover",this.gg,s,this);Zb(a,"mouseout",this.fg,s,this);this.anchor=n;if(0==(this.pb?this.ta?4:1:this.Cc?3:this.ta?2:0))this.ce=s;jg.prototype.bf.call(this)};w.ug=function(a,b){this.anchor==a&&this.Jd.contains(this.anchor)&&(this.ce||!this.mk?(kg(this,s),this.ta||(this.anchor=a,this.Yd=b||vg(this,0)||n,this.ta&&this.Ua(),kg(this,q))):this.anchor=n);this.pb=n};
w.hi=function(a){this.Cc=n;a==this.anchor&&(this.Aa==r||this.Aa!=this.n()&&!this.Jd.contains(this.Aa))&&(!this.Vf||!this.Vf.Aa)&&kg(this,s)};function wg(a,b){var c=Rd(a.Kb);a.Pe.x=b.clientX+c.x;a.Pe.y=b.clientY+c.y}w.Sh=function(a){var b=xg(this,a.target);this.Aa=b;sg(this);b!=this.anchor&&(this.anchor=b,this.pb||(this.pb=cg(ua(this.ug,this,b,n),this.Pg)),yg(this),wg(this,a))};function xg(a,b){try{for(;b&&!a.Jd.contains(b);)b=b.parentNode;return b}catch(c){return r}}
w.Rh=function(a){wg(this,a);this.ce=q};w.Qh=function(a){this.Aa=a=xg(this,a.target);this.ce=q;if(this.anchor!=a){this.anchor=a;var b=vg(this,1);sg(this);this.pb||(this.pb=cg(ua(this.ug,this,a,b),this.Pg));yg(this)}};function vg(a,b){if(0==b){var c=a.Pe.g();return new zg(c)}return new Ag(a.Aa)}function yg(a){if(a.anchor)for(var b,c=0;b=rg[c];c++)Pd(b.n(),a.anchor)&&(b.Vf=a,a.Eg=b)}
w.eg=function(a){var b=xg(this,a.target),c=xg(this,a.relatedTarget);b!=c&&(b==this.Aa&&(this.Aa=r),tg(this),this.ce=s,this.ta&&(!a.relatedTarget||!Pd(this.n(),a.relatedTarget))?ug(this):this.anchor=n)};w.gg=function(){var a=this.n();this.Aa!=a&&(sg(this),this.Aa=a)};w.fg=function(a){var b=this.n();if(this.Aa==b&&(!a.relatedTarget||!Pd(b,a.relatedTarget)))this.Aa=r,ug(this)};function tg(a){a.pb&&(da.clearTimeout(a.pb),a.pb=n)}
function ug(a){if(2==(a.pb?a.ta?4:1:a.Cc?3:a.ta?2:0))a.Cc=cg(ua(a.hi,a,a.anchor),a.Th)}function sg(a){a.Cc&&(da.clearTimeout(a.Cc),a.Cc=n)}function zg(a,b){hg.call(this,a,b)}D(zg,hg);zg.prototype.Ua=function(a,b,c){b=Ud(a);b=Xd(b);c=c?new yd(c.top+10,c.right,c.bottom,c.left+10):new yd(10,0,0,10);fg(this.Oe,a,4,c,b,9)&496&&fg(this.Oe,a,4,c,b,5)};function Ag(a){ig.call(this,a,3)}D(Ag,ig);
Ag.prototype.Ua=function(a,b,c){var d=new wd(10,0);eg(this.element,this.Zf,a,b,d,c,9)&496&&eg(this.element,2,a,1,d,c,5)};function Bg(a,b,c,d){a==r&&l(Error("No valid parent element."));(!y(b)||!y(c))&&l(Error("Invalid coordinates."));(d==r||!(d instanceof me))&&l(Error("Invalid interactor."));pg.call(this);this.c="caption";this.Ja=a;this.Fd=b;this.Gd=c;this.na=d;this.ib=r;this.Pb=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.Pb=[a];Yb(d,ld,this.Td.bind(this));this.Te()}D(Bg,pg);
Bg.prototype.Te=function(){var a=Sd(this.Ja,"position");if("static"==a||""==a)this.Ja.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Kd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.Pb[0]));a.appendChild(b);b.appendChild(c);this.ib=b;this.Yd=new hg(this.Fd,this.Gd)||n;this.ta&&this.Ua();kg(this,q);qg(this,this.Ja);this.n().classList.add("x-tooltip")};
Bg.prototype.Td=function(){kg(this,s);this.ib&&Md(this.ib);this.n()&&Md(this.n());this.ib=r};function Cg(){dg.call(this);this.c="renderer3D";this.Nc=this.Qc=this.Mc=this.Pc=this.Lc=this.Oc=this.ze=this.Ae=r;this.o=[0,0,0];this.Mf=r;this.ie=new wc;this.Vc=new wc;this.Ib=new wc;this.wd=new wc;this.jc=new wc;this.rc=new wc;this.yc=new wc;this.zc=new wc;this.J={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:s,INTERMEDIATE_RENDERING:s}}D(Cg,dg);Cg.prototype.__defineGetter__("config",t("J"));w=Cg.prototype;
w.Ri=function(){this.Nc=this.Qc=this.Mc=this.Pc=this.Lc=this.Oc=r;this.o=[0,0,0]};w.cf=function(a){Cg.q.cf.call(this,a);var b=a.Fd;a=a.Gd;var c=this.Fg(b,a);if(c=this.get(c))if(c=c.ic){var d=$d(this.v);(new Bg(this.v,d.x+b+10,d.y+a+10,this.na)).n().innerHTML=c}};
w.ka=function(){Cg.q.ka.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.H,this.C),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.J.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.H,this.C,0,this.a.RGB,this.a.UNSIGNED_BYTE,r);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,
b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.H,this.C);this.a.bindRenderbuffer(this.a.RENDERBUFFER,r);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.Mf=a}}catch(d){l(Error("Exception while accessing GL Context!\n"+d))}a=new Ee;(this.fa==r||this.a==r||this.r==r)&&l(Error("Renderer was not initialized properly."));
(a==r||!(a instanceof Ee))&&l(Error("Could not add shaders."));b=Object.keys(Ge);Object.keys(Fe).every(function(a){a=Fe[a];return-1!=this.Dd.search(a)||-1!=this.qd.search(a)}.bind(a))||l(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Ge[a];return-1!=this.Dd.search(a)||-1!=this.qd.search(a)}.bind(a))||l(Error("Could not find all uniforms in the shader sources."));b=this.a.createShader(this.a.FRAGMENT_SHADER);c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,
a.qd);this.a.shaderSource(c,a.Dd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||l(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||l(Error("Vertex Shader compilation failed!\n"+this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c);this.a.attachShader(e,b);this.a.linkProgram(e);this.a.getProgramParameter(e,this.a.LINK_STATUS)||l(Error("Could not create shader program!\n"+
this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e)));this.a.useProgram(e);this.ze=e;Object.keys(Fe).forEach(function(a){a=Fe[a];this.ie.set(a,this.a.getAttribLocation(this.ze,a));this.a.enableVertexAttribArray(this.ie.get(a))}.bind(this));Object.keys(Ge).forEach(function(a){a=Ge[a];this.Vc.set(a,this.a.getUniformLocation(this.ze,a))}.bind(this));this.Ae=a};
w.cb=function(a){Cg.q.cb.call(this,a);var b=s;this.get(a.ga)&&(b=q);var c=a.ga,d=a.j,e=a.k,f=a.Z,g=a.za,h=a.m,j=a.Pa,k=a.gb,m=a.P,p=a.w;if(m!=r&&m.m!=r&&m.m.e)this.cb(m);else if(m!=r&&m.e&&this.cb(m),k!=r&&k.m!=r&&k.m.e)this.K.load(k,a);else if(g!=r&&g.m!=r&&g.m.e)this.K.load(g,a);else{if(h!=r&&ka(h))if(a.gc!=r){if(a.gc.Vd!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.K.load(h[b],a);return}else{if(h!=r&&h.e){this.K.load(a,a);return}if(p!=r&&p.m!=r&&p.m.e){this.K.load(p,a);return}}if(0<
a.h.length){h=a.h;k=h.length;for(m=m=0;m<k;m++)this.cb(h[m])}if(d){for(h=0;this.ud;)h++,window.console.log("Possible thread lock avoided: "+h);this.ud=q;k=a instanceof Be&&a.jb instanceof Ie;b&&(g!=r&&g.e)&&(h=this.yc.get(c),h!=r&&this.a.isBuffer(h.B)&&this.a.deleteBuffer(h.B));h=r;g!=r&&(!b||g.e?(h=a.xc,h==r&&l(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),m=s,g.Fb&&(m=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,m),m=this.a.createTexture(),
m.Wh=g.tb,this.zc.set(g.ga,m),this.a.bindTexture(this.a.TEXTURE_2D,m),g.Fb?(this.a.pixelStorei(this.a.UNPACK_ALIGNMENT,1),this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.LUMINANCE,g.xe,g.we,0,this.a.LUMINANCE,this.a.UNSIGNED_BYTE,g.Fb)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,m.Wh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,
this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,r),m=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,m),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new vd(m,h.length,2),g.e=s):h=
this.yc.get(c));Df(this.K,0.1);if(k)this.ud=s,I.qa(this.c+".update"),Df(this.K,0.9);else{if(!b||d.e||j.e){k=j.ha;g=I.d.Ta(k,d.Ub,d.Vb,d.Wb);k=I.d.Ta(k,d.Rb,d.Sb,d.Tb);if(this.Oc===r||g.x<this.Oc)this.Oc=g.x;if(this.Lc===r||k.x>this.Lc)this.Lc=k.x;if(this.Pc===r||g.y<this.Pc)this.Pc=g.y;if(this.Mc===r||k.y>this.Mc)this.Mc=k.y;if(this.Qc===r||g.b<this.Qc)this.Qc=g.b;if(this.Nc===r||k.b>this.Nc)this.Nc=k.b;this.o=[(this.Oc+this.Lc)/2,(this.Pc+this.Mc)/2,(this.Qc+this.Nc)/2];j.e=s}b&&d.e&&(j=this.Ib.get(c),
j!=r&&this.a.isBuffer(j.B)&&this.a.deleteBuffer(j.B));j=r;!b||d.e?(j=this.a.createBuffer(),d.ob(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,d.Q,this.a.STATIC_DRAW),j=new vd(j,d.count,3),d.e=s):j=this.Ib.get(c);Df(this.K,0.3);b&&e.e&&(g=this.Ib.get(c),g!=r&&this.a.isBuffer(g.B)&&this.a.deleteBuffer(g.B));g=r;!b||e.e?(g=this.a.createBuffer(),e.ob(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.Q,this.a.STATIC_DRAW),g=new vd(g,e.count,
3),e.e=s):g=this.wd.get(c);Df(this.K,0.3);b&&(f&&f.e)&&(e=this.jc.get(c),e!=r&&this.a.isBuffer(e.B)&&this.a.deleteBuffer(e.B));e=r;f&&(!b||f.e?(f.length!=d.length&&l(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.ob(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.Q,this.a.STATIC_DRAW),e=new vd(e,f.count,3),f.e=s):e=this.jc.get(c));Df(this.K,0.2);b&&(p&&p.e)&&(f=this.rc.get(c),f!=r&&this.a.isBuffer(f.B)&&this.a.deleteBuffer(f.B));f=
r;p&&(f=p.Fc,!b||p.e?(f.length!=d.length&&l(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new vd(d,f.length,3),p.e=s):f=this.rc.get(c));Df(this.K,0.1);b||this.Za.add(a);this.Ib.set(c,j);this.wd.set(c,g);this.jc.set(c,e);this.yc.set(c,h);this.rc.set(c,f);this.ud=a.e=s}}else a.e=s}};
function Dg(a,b){var c=b.j.od,c=I.d.Ta(b.Pa.ha,c[0],c[1],c[2]),c=I.d.Ta(a.r.p,c.x,c.y,c.b),c=I.f.kb(a.r.ya,c);return Math.round(1E3*c)/1E3}w.Fg=function(a,b){if(this.J.PICKING_ENABLED){this.Nb(q,s);var c=new Uint8Array(4);this.a.readPixels(a,this.C-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
w.Nb=function(a,b){Cg.q.Nb.call(this,a,b);this.a.viewport(0,0,this.H,this.C);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.Za.u,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Mf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);var e=this.r.Lf,f=this.r.p;this.a.uniformMatrix4fv(this.Vc.get("perspective"),s,e);this.a.uniformMatrix4fv(this.Vc.get("view"),s,f);e=this.o;this.a.uniform3f(this.Vc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.Ka.length;for(e=0;e<f;++e){var g=this.Ka[e];if(g instanceof P){var h=I.d.Ta(this.r.p,1,0,0),j=I.f.kb(this.r.ya,h),h=I.d.Ta(this.r.p,-1,0,0),k=I.f.kb(this.r.ya,h),h=I.d.Ta(this.r.p,0,1,0),m=I.f.kb(this.r.ya,h),h=I.d.Ta(this.r.p,0,-1,0),p=I.f.kb(this.r.ya,h),h=I.d.Ta(this.r.p,0,0,1),u=I.f.kb(this.r.ya,h),h=I.d.Ta(this.r.p,0,0,-1),h=I.f.kb(this.r.ya,h),x=Math.max(j,m,u,k,p,h);x==j||x==k?He(g,0):x==m||x==p?He(g,1):(x==u||x==h)&&He(g,2)}}if(this.J.ORDERING_ENABLED){j=s;f=this.Ka;g=f.length-1;do if(e=
f[g],e instanceof P&&e.Qa){k=e.Jb;j=e.uc.h;1==k?j=e.vc.h:2==k&&(j=e.wc.h);k=j.length;m=j[0];m.O=Dg(this,m);m.ba=e.ba;p=j[k-1];p.O=Dg(this,p);p.ba=e.ba;p=Math.round(1E3*((p.O-m.O)/k))/1E3;for(u=u=1;u<k-1;u++)h=Math.round(1E3*(m.O+u*p))/1E3,j[u].O=h,j[u].ba=e.ba;j=q}while(g--);f=this.Za.u;g=f.length-1;do if(e=f[g],e.sa&&!(1==e.ba||e instanceof Be))e.O=Dg(this,e),j=q;while(g--);j&&this.Za.sort()}if(f=!a&&b!=r&&b&&this.J.STATISTICS_ENABLED)var v=0,z=0,F=0,E=0;var e=this.ie,g=e.get("vertexPosition"),j=
e.get("vertexNormal"),k=e.get("vertexColor"),m=e.get("vertexTexturePos"),p=e.get("vertexScalar"),e=this.Vc,u=e.get("usePicking"),h=e.get("useObjectColor"),x=e.get("objectColor"),H=e.get("useScalars"),B=e.get("scalarsReplaceMode"),G=e.get("scalarsMin"),J=e.get("scalarsMax"),U=e.get("scalarsMinColor"),N=e.get("scalarsMaxColor"),K=e.get("scalarsInterpolation"),O=e.get("scalarsMinThreshold"),R=e.get("scalarsMaxThreshold"),S=e.get("objectOpacity"),V=e.get("labelmapOpacity"),ja=e.get("labelmapColor"),A=
e.get("useTexture"),T=e.get("useLabelMapTexture"),ha=e.get("textureSampler"),Da=e.get("textureSampler2"),hb=e.get("volumeLowerThreshold"),nc=e.get("volumeUpperThreshold"),Od=e.get("volumeScalarMin"),ib=e.get("volumeScalarMax"),Sb=e.get("volumeWindowLow"),Ig=e.get("volumeWindowHigh"),Jg=e.get("volumeScalarMinColor"),Kg=e.get("volumeScalarMaxColor"),Vf=e.get("volumeTexture"),Lg=e.get("objectTransform"),Mg=e.get("pointSize"),e=d;do{var ca=c[d-e];if(ca){var ia=r;ca instanceof Be&&ca.jb&&(ia=ca.jb);if(ca.sa&&
(!ia||ia.sa)&&(!a||ca.Rc)){var wa=ca.ga,$a=ca.Kc,Ja=this.Ib.get(wa),jb=this.wd.get(wa),ye=this.jc.get(wa),Ab=this.rc.get(wa),ze=this.yc.get(wa);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ja.B);this.a.vertexAttribPointer(g,Ja.yb,this.a.FLOAT,s,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,jb.B);this.a.vertexAttribPointer(j,jb.yb,this.a.FLOAT,s,0,0);a?this.a.uniform1i(u,q):this.a.uniform1i(u,s);ye&&!a&&!$a?(this.a.uniform1i(h,s),this.a.bindBuffer(this.a.ARRAY_BUFFER,ye.B),this.a.vertexAttribPointer(k,ye.yb,
this.a.FLOAT,s,0,0)):(jb=1,$a&&!a&&(jb=0),this.a.uniform1i(h,jb),jb=ca.Ob,a&&(jb=[Math.floor(wa%65025%255)/255,Math.floor(wa%65025/255)/255,Math.floor(wa/65025)/255]),this.a.uniform3f(x,parseFloat(jb[0]),parseFloat(jb[1]),parseFloat(jb[2])),this.a.vertexAttribPointer(k,Ja.yb,this.a.FLOAT,s,0,0));Ab&&!a&&!$a?(this.a.uniform1i(H,q),this.a.uniform1i(B,ca.w.Of),wa=ca.w.Cb,$a=ca.w.Ab,this.a.uniform3f(U,parseFloat(wa[0]),parseFloat(wa[1]),parseFloat(wa[2])),this.a.uniform3f(N,parseFloat($a[0]),parseFloat($a[1]),
parseFloat($a[2])),this.a.uniform1f(O,parseFloat(ca.w.U)),this.a.uniform1f(R,parseFloat(ca.w.V)),this.a.uniform1f(G,parseFloat(ca.w.Na)),this.a.uniform1f(J,parseFloat(ca.w.$)),this.a.uniform1i(K,parseInt(ca.w.le,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ab.B),this.a.vertexAttribPointer(p,Ab.yb,this.a.FLOAT,s,0,0)):(this.a.uniform1i(H,s),this.a.vertexAttribPointer(p,Ja.yb,this.a.FLOAT,s,0,0));this.a.uniform1f(S,parseFloat(ca.ba));ca.za&&ze&&!a?(this.a.uniform1i(A,q),this.a.activeTexture(this.a.TEXTURE0),
this.a.bindTexture(this.a.TEXTURE_2D,this.zc.get(ca.za.ga)),this.a.uniform1i(ha,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,ze.B),this.a.vertexAttribPointer(m,ze.yb,this.a.FLOAT,s,0,0),this.a.uniform1i(Vf,s)):(this.a.uniform1i(A,s),this.a.vertexAttribPointer(m,Ja.yb,this.a.FLOAT,s,0,0));ia&&(this.a.uniform1i(Vf,q),this.a.uniform1f(hb,ia.U),this.a.uniform1f(nc,ia.V),this.a.uniform1f(Od,ia.Na),this.a.uniform1f(ib,ia.$),wa=ia.Cb,$a=ia.Ab,this.a.uniform3f(Jg,parseFloat(wa[0]),parseFloat(wa[1]),parseFloat(wa[2])),
this.a.uniform3f(Kg,parseFloat($a[0]),parseFloat($a[1]),parseFloat($a[2])),this.a.uniform1f(Sb,ia.X),this.a.uniform1f(Ig,ia.W),Ab=ia.P,this.a.uniform1i(T,s),ia.Qa?this.a.uniform1f(S,parseFloat(ia.ba)):Ab&&Ab.sa&&(ia=ca.P.ga,this.a.uniform1i(T,q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.zc.get(ia)),this.a.uniform1i(Da,1),this.a.uniform1f(V,Ab.ba),this.a.uniform4fv(ja,Ab.Be)));this.a.uniformMatrix4fv(Lg,s,ca.Pa.ha);ia=1;"POINTS"==ca.oa&&(ia=ca.Sc);this.a.uniform1f(Mg,
ia);ia=-1;ca.oa==Uc?(ia=this.a.TRIANGLES,f&&(z+=Ja.xb/3)):"LINES"==ca.oa?(this.a.lineWidth(ca.oc),ia=this.a.LINES,f&&(F+=Ja.xb/2)):"POINTS"==ca.oa?(ia=this.a.POINTS,f&&(E+=Ja.xb)):"TRIANGLE_STRIPS"==ca.oa?(ia=this.a.TRIANGLE_STRIP,f&&(z+=Ja.xb/3)):"POLYGONS"==ca.oa&&(ia=0==Ja.xb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(z+=Ja.xb/3));f&&(v+=Ja.xb);this.a.drawArrays(ia,0,Ja.xb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+v+" | "),c+="Triangles: "+Math.round(z)+" | ",c+="Lines: "+F+" | ",c+=
"Points: "+E+" | ",c+="Textures: "+this.zc.Nd(),window.console.log(c))}};
w.remove=function(a){Cg.q.remove.call(this,a);if(0<a.h.length)for(var b=a.h,c=b.length,d=0,d=0;d<c;d++)this.remove(b[d]);b=a.ga;if(this.get(b)){c=this.yc.get(b);c!=r&&this.a.isBuffer(c.B)&&this.a.deleteBuffer(c.B);if(a.nk&&(c=this.zc.get(a.za.ga)))this.a.deleteTexture(c),this.zc.remove(a.za.ga);c=this.Ib.get(b);c!=r&&this.a.isBuffer(c.B)&&this.a.deleteBuffer(c.B);c=this.Ib.get(b);c!=r&&this.a.isBuffer(c.B)&&this.a.deleteBuffer(c.B);c=this.jc.get(b);c!=r&&this.a.isBuffer(c.B)&&this.a.deleteBuffer(c.B);
c=this.rc.get(b);c!=r&&this.a.isBuffer(c.B)&&this.a.deleteBuffer(c.B);this.Ib.remove(b);this.wd.remove(b);this.jc.remove(b);this.yc.remove(b);this.rc.remove(b);this.Za.remove(a);return q}return s};w.Id=function(){this.Ae=r;delete this.Ae;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);Cg.q.Id.call(this)};C("X.renderer3D",Cg);C("X.renderer3D.prototype.init",Cg.prototype.ka);C("X.renderer3D.prototype.add",Cg.prototype.add);C("X.renderer3D.prototype.onShowtime",Cg.prototype.Bg);
C("X.renderer3D.prototype.onRender",Cg.prototype.zg);C("X.renderer3D.prototype.get",Cg.prototype.get);C("X.renderer3D.prototype.render",Cg.prototype.fc);C("X.renderer3D.prototype.destroy",Cg.prototype.Id);C("X.renderer3D.prototype.remove",Cg.prototype.remove);C("X.renderer3D.prototype.resetBoundingBox",Cg.prototype.Ri);C("X.renderer3D.prototype.resetViewAndRender",Cg.prototype.jd);C("X.renderer3D.prototype.pick",Cg.prototype.Fg);function Eg(){Y.call(this);this.c="mesh";Fa(this,new uc)}D(Eg,Y);C("X.mesh",Eg);function Fg(){Y.call(this);this.c="fibers";Fa(this,new uc)}D(Fg,Y);C("X.fibers",Fg);function Gg(){dg.call(this);this.c="renderer2D";this.Oa=r;this.Xb=-1;this.pc=[];this.Df=this.me=this.Bf=this.ke=r;this.sc=this.tc=this.Ad=this.Bd=0;this.W=this.X=this.V=this.U=this.zf=-1;this.Ef=new Float32Array([-255,-255,-255,-255]);this.yd=q}D(Gg,dg);Gg.prototype.Ai=aa();Gg.prototype.Ji=aa();Gg.prototype.ef=function(a){Gg.q.ef.call(this,a);var b=this.Ka[0];if(b){var c=this.Xb,d="",d=0==c?"indexX":1==c?"indexY":"indexZ";b[d]=a.M?b[d]+1:b[d]-1;eval("this.onScroll();")}};
Gg.prototype.Ki=function(a){var b=this.Ka[0];if(b){var c=b.W-b.X,d=c/2,e=parseInt(c+c/15*-a.Fe,10);a=parseInt(d+d/15*a.re,10);c==e&&e++;d==a&&a++;b.X-=parseInt(d-a,10);b.X-=parseInt(c-e,10);b.X=Math.max(b.X,b.Na);b.W-=parseInt(d-a,10);b.W+=parseInt(c-e,10);b.W=Math.min(b.W,b.$);eval("this.onWindowLevel();")}};Gg.prototype.__defineGetter__("orientation",t("Oa"));
Gg.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"AXIAL"==a?a="Z":"SAGITTAL"==a?a="X":"CORONAL"==a&&(a="Y");"X"!=a&&("Y"!=a&&"Z"!=a)&&l(Error("Invalid orientation."));this.Oa=a;if(a=this.Ka[0])this.Xb=Hg(a.G,this.Oa)});Gg.prototype.__defineGetter__("radiological",t("yd"));Gg.prototype.__defineSetter__("radiological",ba("yd"));w=Gg.prototype;
w.ka=function(){this.Oa||l(Error("No 2D orientation set."));Gg.q.ka.call(this,"2d");this.a.fillStyle="rgba(50,50,50,0)";this.a.fillRect(0,0,this.fa.width,this.fa.height);this.ke=Kd("canvas");this.me=Kd("canvas");Vb(this.r,hd,this.Ki.bind(this))};w.df=function(){Gg.q.df.call(this);Ng(this)};w.jd=function(){Gg.q.jd.call(this);Ng(this);var a=this.Ka[0];a&&(a.W=a.$,a.X=a.Na)};
function Hg(a,b){if("X"==b){if(0!=a[2][0])return 0;if(0!=a[0][0])return 1}else if("Y"==b){if(0!=a[2][1])return 0;if(0!=a[0][1])return 1}else{if(0!=a[2][2])return 0;if(0!=a[0][2])return 1}return 2}
w.cb=function(a){Gg.q.cb.call(this,a);var b=s;this.get(a.ga)&&(b=q);if(a instanceof P){var c=a.m,d=a.P,e=a.gb;if(d!=r&&d.m!=r&&d.m.e)this.cb(d);else if(e!=r&&e.m!=r&&e.m.e)this.K.load(e,a);else{if(c!=r&&ka(c))if(a.gc!=r){if(a.gc.Vd!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.K.load(c[b],a);return}else if(c!=r&&c.e){this.K.load(a,a);return}var c=a.Hb,f=a.G,g=a.Ia,d=this.Xb=Hg(f,this.Oa),e=(d+1)%3,h=(d+2)%3;if(0!=f[2][1])var j=d,d=e,e=j;0!=f[h][1]&&(j=d,d=e,e=j);f=g[d];g=g[e];
this.Uc=a.h[this.Xb].h;this.tc=c[d];this.sc=c[e];this.Bd=f;this.Ad=g;c=this.ke;c.width=f;c.height=g;d=this.me;d.width=f;d.height=g;this.Bf=c.getContext("2d");this.Df=d.getContext("2d");b||(this.Za.add(a),Ng(this))}}};function Ng(a){var b=Math.min(a.H/(a.Bd*a.tc),a.C/(a.Ad*a.sc));a.r.p[14]=b}
w.Vg=function(a,b){var c=this.Ka[0],d=this.r.p,e=1*d[12],f=-1*d[13],d=Math.max(d[14],0.6),g=[this.H/2,this.C/2],h=this.Bd*this.tc*d,j=this.Ad*this.sc*d,k=g[0]-h/2,g=g[1]-j/2,k=k+e*d,m=0,p=0,u=this.Xb,e=(u+1)%3,x=(u+2)%3;0!=c.G[x][2]?(this.pc[0]="yellow",this.pc[1]="green"):(this.pc[0]=0!=c.G[x][1]?"yellow":"green",this.pc[1]="red");var u=c.Ia[u],v=c.Ia[e];0!=c.G[x][1]&&(m=u,u=v,v=m,m=e,e=x,x=m);0!=c.G[2][1]&&(m=u,u=v,v=m,m=e,e=x,x=m);c=[Math.floor(c.T),Math.floor(c.ca),Math.floor(c.da)];m=this.yd?
Math.floor(u-(a-k)/h*u):Math.floor((a-k)/h*u);p=Math.floor(v-(b-(g+f*d))/j*v);if(0>m||m>=u||0>p||p>=v)return r;c[e]=m;c[x]=p;return c};
w.Nb=function(a,b){Gg.q.Nb.call(this,a,b);if(0!=this.Za.u.length){var c=this.H,d=this.C,e=this.r.p;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e[12],g=-1*e[13],h=Math.max(e[14],0.6);this.a.setTransform(h,0,0,h,0,0);var e=this.Ka[0],j=r;e.P&&(j=e.P.Be);var k=this.Xb,m=r,m=0==k?e.indexX:1==k?e.indexY:e.indexZ,p=this.Uc[parseInt(m,10)],u=p.za.Fb,p=p.P,x=r;p&&(x=p.Fb);var v=this.Bd,z=this.Ad,F=this.Bf,E=this.Df,H=F.getImageData(0,0,v,z),B=E.getImageData(0,0,v,z),G=H.data,J=
B.data,U=G.length,N=e.Oa,K=e.G,O=e.$,R=e.U,S=e.V,V=e.X/O,ja=e.W/O;if(this.zf!=m||this.U!=R||this.V!=S||this.X!=V||this.W!=ja||j&&!Nf(j,this.Ef,0)){var A=0;do{var T=[0,0,0,0],ha=[0,0,0,0],Da=u[A]/255*O,hb=u[A],hb=(hb/255-V)/(ja-V),hb=255*hb;Da>=R&&Da<=S&&(T=new Q(e.Cb[0],e.Cb[1],e.Cb[2]),T=(new Q(e.Ab[0],e.Ab[1],e.Ab[2])).scale(hb).add(T.scale(255-hb)),T=[Math.floor(T.x),Math.floor(T.y),Math.floor(T.b),255],p&&(-255==j[3]?ha=[x[A],x[A+1],x[A+2],x[A+3]]:Nf(j,x,A)&&(ha=[x[A],x[A+1],x[A+2],x[A+3]])));
var Da=k,nc=(Da+1)%3,Od=(Da+2)%3,hb=A,ib=N[Da],Sb=N[nc];0!=K[Od][0]?0!=K[2][1]?(A=4*(A/4%z*v+Math.floor(A/4/z)),ib=-N[nc],Sb=N[Da]):ib*=-1:(0!=K[Od][1]?0==K[2][1]&&(A=4*(A/4%z*v+Math.floor(A/4/z)),ib=N[nc],Sb=N[Da]):0!=K[2][1]&&(A=4*(A/4%z*v+Math.floor(A/4/z)),ib=N[nc],Sb=N[Da]),this.yd&&(ib*=-1));1==ib?(1==Sb&&(A=4*v*(z-Math.floor(A/(4*v)))+A%(4*v)),G[A]=T[0],G[A+1]=T[1],G[A+2]=T[2],G[A+3]=T[3],J[A]=ha[0],J[A+1]=ha[1],J[A+2]=ha[2],J[A+3]=ha[3]):1==Sb?(A=U-1-A,G[A-3]=T[0],G[A-2]=T[1],G[A-1]=T[2],
G[A]=T[3],J[A-3]=ha[0],J[A-2]=ha[1],J[A-1]=ha[2],J[A]=ha[3]):(A=4*v*Math.floor(A/(4*v))-A%(4*v),G[A]=T[0],G[A+1]=T[1],G[A+2]=T[2],G[A+3]=T[3],J[A]=ha[0],J[A+1]=ha[1],J[A+2]=ha[2],J[A+3]=ha[3]);A=hb+4}while(A<U);F.putImageData(H,0,0);E.putImageData(B,0,0);this.zf=m;this.U=R;this.V=S;this.X=V;this.W=ja;p&&(this.Ef=j)}this.a.globalAlpha=1;this.a.translate(c/2/h,d/2/h);c=-v*this.tc/2+f;g=-z*this.sc/2+g;this.a.drawImage(this.ke,c,g,v*this.tc,z*this.sc);p&&e.P.sa&&(this.a.globalAlpha=e.P.ba,this.a.drawImage(this.me,
c,g,v*this.tc,z*this.sc));if(this.J.SLICENAVIGATORS&&(this.na.vd&&this.na.Pf&&!this.na.Ya)&&(g=this.na.hb,g=this.Vg(g[0],g[1])))e.T=g[0],e.ca=g[1],e.da=g[2],e.l(s),this.a.setTransform(1,0,0,1,0,0),this.a.lineWidth=1,this.a.beginPath(),this.a.moveTo(this.na.hb[0]+0.5,0),this.a.lineTo(this.na.hb[0]+0.5,this.C),this.a.strokeStyle=this.pc[0],this.a.stroke(),this.a.closePath(),this.a.beginPath(),this.a.moveTo(0,this.na.hb[1]+0.5),this.a.lineTo(this.H,this.na.hb[1]+0.5),this.a.strokeStyle=this.pc[1],this.a.stroke(),
this.a.closePath()}};C("X.renderer2D",Gg);C("X.renderer2D.prototype.init",Gg.prototype.ka);C("X.renderer2D.prototype.add",Gg.prototype.add);C("X.renderer2D.prototype.onShowtime",Gg.prototype.Bg);C("X.renderer2D.prototype.onRender",Gg.prototype.zg);C("X.renderer2D.prototype.onScroll",Gg.prototype.Ai);C("X.renderer2D.prototype.onWindowLevel",Gg.prototype.Ji);C("X.renderer2D.prototype.get",Gg.prototype.get);C("X.renderer2D.prototype.resetViewAndRender",Gg.prototype.jd);
C("X.renderer2D.prototype.xy2ijk",Gg.prototype.Vg);C("X.renderer2D.prototype.render",Gg.prototype.fc);C("X.renderer2D.prototype.destroy",Gg.prototype.Id);
